<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fabric Compute Cost Optimisation Guide</title>
    <style>
        /* ============================================ */
        /* Claude-inspired UI â€” warm, elegant, refined  */
        /* Cream tones, terracotta accents, soft depth  */
        /* ============================================ */

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fraunces:opsz,wght@9..144,300;9..144,400;9..144,500;9..144,600;9..144,700&display=swap');

        :root {
            --text-primary: #2D2B28;
            --text-secondary: #6B6560;
            --text-tertiary: #9B9490;
            --bg-primary: #FAF8F5;
            --bg-secondary: #F1EDE8;
            --bg-card: #FFFFFF;
            --border-light: #E0DBD5;
            --border-subtle: #EAE5DF;
            --accent: #C4653A;
            --accent-hover: #B55A32;
            --accent-soft: rgba(196, 101, 58, 0.08);
            --green: #5B8C5A;
            --green-bg: #EEF4ED;
            --green-text: #3D6B3C;
            --orange: #C4883A;
            --orange-bg: #FDF3E7;
            --orange-text: #8B5E1E;
            --grey: #8B8580;
            --grey-bg: #F0ECE8;
            --grey-text: #6B6560;
            --blue-bg: #EBF0F5;
            --blue-text: #4A6B8A;
            --yellow-bg: #F9F3E3;
            --yellow-text: #7D6A2E;
            --peach-bg: #FBF0EA;
            --peach-text: #8B5A3A;
            --red-bg: #F8EDEC;
            --red-text: #A04040;
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --shadow-sm: 0 1px 3px rgba(45,43,40,0.04), 0 1px 2px rgba(45,43,40,0.03);
            --shadow-md: 0 4px 16px rgba(45,43,40,0.06), 0 1px 4px rgba(45,43,40,0.03);
            --shadow-lg: 0 12px 40px rgba(45,43,40,0.08), 0 4px 12px rgba(45,43,40,0.04);
            --transition: 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: var(--bg-primary);
            padding: 56px 48px 72px;
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1140px;
            margin: 0 auto;
        }

        /* ---- Brand Header ---- */
        .brand-header {
            display: flex;
            align-items: center;
            gap: 18px;
            padding-bottom: 36px;
            margin-bottom: 36px;
            border-bottom: 1px solid var(--border-subtle);
        }
        .brand-header .fabric-logo {
            flex-shrink: 0;
            border-radius: 12px;
        }
        .brand-header .brand-text {
            display: flex;
            flex-direction: column;
        }
        .brand-header .brand-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 2px;
        }
        .brand-header .brand-author {
            font-size: 12px;
            color: var(--text-tertiary);
            font-weight: 400;
        }

        /* ---- Typography ---- */
        h1 {
            font-family: 'Fraunces', Georgia, 'Times New Roman', serif;
            font-size: 38px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
            letter-spacing: -0.3px;
            line-height: 1.2;
        }
        .subtitle {
            font-size: 15px;
            color: var(--text-secondary);
            margin-bottom: 36px;
            font-weight: 400;
            line-height: 1.6;
        }

        /* ---- Navigation Buttons ---- */
        .nav-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 44px;
            flex-wrap: wrap;
        }
        .nav-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 26px;
            border-radius: 980px;
            font-size: 13.5px;
            font-weight: 500;
            text-decoration: none;
            transition: all var(--transition);
            letter-spacing: 0px;
        }
        .nav-btn-primary {
            background: var(--accent);
            color: #fff;
            box-shadow: 0 2px 8px rgba(196, 101, 58, 0.25);
        }
        .nav-btn-primary:hover {
            background: var(--accent-hover);
            color: #fff;
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(196, 101, 58, 0.3);
        }
        .nav-btn-outline {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-light);
        }
        .nav-btn-outline:hover {
            background: var(--bg-secondary);
            border-color: var(--border-light);
            transform: translateY(-1px);
        }

        /* ---- Summary Box ---- */
        .summary-box {
            background: var(--bg-card);
            padding: 32px 36px;
            margin-bottom: 44px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-subtle);
            box-shadow: var(--shadow-sm);
        }
        .summary-box h3 {
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 18px;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        .summary-stats {
            display: flex;
            gap: 40px;
            flex-wrap: wrap;
        }
        .stat { text-align: center; }
        .stat-number {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 36px;
            font-weight: 600;
            color: var(--text-primary);
            letter-spacing: -1px;
        }
        .stat-label {
            font-size: 11px;
            color: var(--text-tertiary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }

        /* ---- Category Sections ---- */
        .category-section {
            margin-bottom: 48px;
            page-break-inside: avoid;
        }
        .category-header {
            background: var(--text-primary);
            color: #FAF8F5;
            padding: 16px 28px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 0;
            border-radius: var(--radius-md) var(--radius-md) 0 0;
            letter-spacing: 0px;
        }
        .category-header.alt {
            background: #3D3A36;
        }

        /* ---- Tables ---- */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 13px;
            border: 1px solid var(--border-subtle);
            border-top: none;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            overflow: hidden;
            background: var(--bg-card);
        }
        th {
            background: var(--bg-secondary);
            padding: 12px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-light);
        }
        td {
            padding: 15px 18px;
            border-bottom: 1px solid var(--border-subtle);
            vertical-align: top;
            color: var(--text-primary);
            line-height: 1.55;
        }
        tr:last-child td {
            border-bottom: none;
        }
        tr:hover {
            background: var(--accent-soft);
        }
        a {
            color: var(--accent);
            text-decoration: none;
            font-size: 12px;
            font-weight: 500;
        }
        a:hover {
            text-decoration: underline;
            color: var(--accent-hover);
        }

        /* Recommendations table columns */
        .recs-section th:first-child { width: 5%; }
        .recs-section th:nth-child(2) { width: 42%; }
        .recs-section th:nth-child(3) { width: 38%; }
        .recs-section th:nth-child(4) { width: 15%; text-align: center; }
        .recs-section td:first-child { font-weight: 600; color: var(--accent); font-size: 13px; }
        .recs-section td:last-child { text-align: center; }

        /* Matrix table columns */
        .matrix-section td:first-child { font-weight: 600; color: var(--accent); font-size: 13px; }

        /* ---- Benefit Badges ---- */
        .benefit-high {
            background: var(--green-bg);
            color: var(--green-text);
            padding: 4px 14px;
            border-radius: 980px;
            font-weight: 600;
            font-size: 11px;
            display: inline-block;
            letter-spacing: 0.3px;
        }
        .benefit-mid {
            background: var(--orange-bg);
            color: var(--orange-text);
            padding: 4px 14px;
            border-radius: 980px;
            font-weight: 600;
            font-size: 11px;
            display: inline-block;
            letter-spacing: 0.3px;
        }
        .benefit-low {
            background: var(--grey-bg);
            color: var(--grey-text);
            padding: 4px 14px;
            border-radius: 980px;
            font-weight: 600;
            font-size: 11px;
            display: inline-block;
            letter-spacing: 0.3px;
        }

        /* ---- Value Type & Effort Tags ---- */
        .vtype-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 980px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
            margin: 2px 2px;
            letter-spacing: 0.1px;
        }
        .effort-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 980px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
            letter-spacing: 0.1px;
        }

        /* ---- Section Divider ---- */
        .section-divider {
            margin: 80px 0 44px 0;
            padding-top: 52px;
            border-top: 1px solid var(--border-light);
        }
        .section-divider h2 {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 30px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
            letter-spacing: -0.3px;
        }
        .section-divider p {
            font-size: 15px;
            color: var(--text-secondary);
            margin-bottom: 22px;
            font-weight: 400;
            line-height: 1.6;
        }

        /* ---- Matrix Stats ---- */
        .matrix-stats {
            display: flex;
            gap: 16px;
            margin-bottom: 36px;
            flex-wrap: wrap;
        }
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            padding: 22px 24px;
            text-align: center;
            flex: 1;
            min-width: 120px;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition);
        }
        .stat-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
            border-color: var(--border-light);
        }
        .stat-card .sc-number {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 30px;
            font-weight: 600;
            color: var(--text-primary);
            letter-spacing: -1px;
        }
        .stat-card .sc-label {
            font-size: 11px;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 6px;
            font-weight: 500;
        }

        /* ---- Legend ---- */
        .legend-container {
            display: flex;
            gap: 20px;
            margin-bottom: 44px;
            flex-wrap: wrap;
        }
        .legend-box {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            padding: 22px 26px;
            flex: 1;
            min-width: 300px;
            box-shadow: var(--shadow-sm);
        }
        .legend-box h3 {
            font-size: 11px;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        .legend-count {
            font-weight: 700;
            color: var(--text-tertiary);
            min-width: 28px;
            text-align: right;
            font-size: 12px;
        }

        /* ---- Page Break & Footer ---- */
        .page-break {
            page-break-after: always;
            margin: 52px 0;
            border-top: 1px solid var(--border-subtle);
            padding-top: 52px;
        }
        .footer {
            margin-top: 72px;
            padding-top: 28px;
            border-top: 1px solid var(--border-subtle);
            font-size: 12px;
            color: var(--text-tertiary);
            display: flex;
            justify-content: space-between;
            font-weight: 400;
        }

        /* ---- Metadata Section ---- */
        .metadata-section td:first-child { font-weight: 600; color: var(--accent); font-size: 13px; }
        code {
            font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', Consolas, monospace;
            font-size: 11.5px;
            background: var(--bg-secondary);
            padding: 3px 8px;
            border-radius: 6px;
            color: var(--text-primary);
            font-weight: 500;
            border: 1px solid var(--border-subtle);
        }

        /* ---- Search ---- */
        .search-container {
            position: relative;
            margin-bottom: 44px;
        }
        .search-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }
        .search-icon {
            position: absolute;
            left: 18px;
            color: var(--text-tertiary);
            pointer-events: none;
            transition: color var(--transition);
        }
        .search-input {
            width: 100%;
            padding: 16px 18px 16px 50px;
            font-size: 15px;
            font-family: inherit;
            font-weight: 400;
            color: var(--text-primary);
            background: var(--bg-card);
            border: 1.5px solid var(--border-light);
            border-radius: var(--radius-md);
            outline: none;
            transition: all var(--transition);
            -webkit-font-smoothing: antialiased;
            box-shadow: var(--shadow-sm);
        }
        .search-input::placeholder {
            color: var(--text-tertiary);
            font-weight: 400;
        }
        .search-input:focus {
            background: var(--bg-card);
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(196, 101, 58, 0.1), var(--shadow-sm);
        }
        .search-input:focus + .search-kbd,
        .search-input:not(:placeholder-shown) + .search-kbd {
            opacity: 1;
        }
        .search-kbd {
            position: absolute;
            right: 16px;
            font-size: 11px;
            font-family: inherit;
            font-weight: 500;
            color: var(--text-tertiary);
            background: var(--bg-primary);
            border: 1px solid var(--border-light);
            border-radius: 6px;
            padding: 3px 8px;
            opacity: 0;
            transition: opacity var(--transition);
            pointer-events: none;
        }
        .search-results {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            max-height: 420px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }
        .search-results.active {
            display: block;
        }
        .search-result-item {
            padding: 14px 22px;
            cursor: pointer;
            border-bottom: 1px solid var(--border-subtle);
            transition: background var(--transition);
            display: flex;
            align-items: flex-start;
            gap: 14px;
        }
        .search-result-item:last-child {
            border-bottom: none;
        }
        .search-result-item:hover,
        .search-result-item.active {
            background: var(--accent-soft);
        }
        .search-result-num {
            font-weight: 700;
            color: var(--accent);
            font-size: 13px;
            min-width: 32px;
            flex-shrink: 0;
        }
        .search-result-text {
            font-size: 13px;
            color: var(--text-primary);
            line-height: 1.5;
        }
        .search-result-text mark {
            background: rgba(196, 101, 58, 0.12);
            color: var(--accent);
            border-radius: 3px;
            padding: 0 2px;
            font-weight: 600;
        }
        .search-result-meta {
            font-size: 11px;
            color: var(--text-tertiary);
            margin-top: 4px;
        }
        .search-no-results {
            padding: 22px;
            text-align: center;
            color: var(--text-tertiary);
            font-size: 14px;
        }
        .search-highlight {
            animation: highlightPulse 2.5s ease-out;
        }
        @keyframes highlightPulse {
            0% { background: rgba(196, 101, 58, 0.12); }
            100% { background: transparent; }
        }

        /* ---- F-SKU Wizard ---- */
        .fsku-section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 36px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 48px;
        }
        .wizard-progress {
            height: 6px;
            background: var(--bg-secondary);
            border-radius: 980px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        .wizard-progress-bar {
            height: 100%;
            background: var(--accent);
            border-radius: 980px;
            width: 0%;
            transition: width 0.4s ease;
        }
        .wizard-progress-text {
            font-size: 12px;
            color: var(--text-tertiary);
            text-align: center;
            margin-bottom: 24px;
            font-weight: 500;
        }
        .wizard-stages {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }
        .wizard-stage-btn {
            flex: 1;
            min-width: 140px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 14px 12px;
            background: var(--bg-secondary);
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition);
            font-family: inherit;
        }
        .wizard-stage-btn:hover {
            background: var(--bg-primary);
            border-color: var(--border-light);
        }
        .wizard-stage-btn.active {
            background: var(--accent-soft);
            border-color: var(--accent);
        }
        .wizard-stage-btn.completed {
            background: var(--green-bg);
            border-color: var(--green);
        }
        .stage-icon { font-size: 20px; }
        .stage-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: center;
        }
        .wizard-panel { animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .panel-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 28px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-subtle);
        }
        .panel-icon { font-size: 32px; }
        .panel-header h3 {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 22px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        .panel-header p {
            font-size: 13px;
            color: var(--text-secondary);
        }
        .wizard-question {
            margin-bottom: 28px;
            padding: 20px 24px;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-subtle);
        }
        .question-number {
            font-size: 11px;
            font-weight: 700;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .question-text {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 16px;
            line-height: 1.5;
        }
        .multi-hint {
            font-size: 12px;
            font-weight: 400;
            color: var(--text-tertiary);
            font-style: italic;
        }
        .option-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }
        .option-chip {
            display: inline-flex;
            align-items: center;
            cursor: pointer;
        }
        .option-chip input { display: none; }
        .chip-text {
            display: inline-block;
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1.5px solid var(--border-light);
            border-radius: 980px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all var(--transition);
            cursor: pointer;
        }
        .chip-text:hover {
            border-color: var(--accent);
            color: var(--text-primary);
        }
        .option-chip input:checked + .chip-text {
            background: var(--accent);
            color: #fff;
            border-color: var(--accent);
            box-shadow: 0 2px 8px rgba(196, 101, 58, 0.25);
        }
        .wizard-notes {
            width: 100%;
            padding: 10px 14px;
            font-family: inherit;
            font-size: 13px;
            border: 1.5px solid var(--border-light);
            border-radius: var(--radius-sm);
            background: var(--bg-card);
            color: var(--text-primary);
            resize: vertical;
            min-height: 40px;
            max-height: 120px;
            outline: none;
            transition: border-color var(--transition);
        }
        .wizard-notes:focus {
            border-color: var(--accent);
        }
        .wizard-notes::placeholder {
            color: var(--text-tertiary);
        }
        .wizard-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid var(--border-subtle);
        }
        .wiz-nav-btn {
            padding: 12px 24px;
            border-radius: 980px;
            font-size: 13px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            border: 1.5px solid var(--border-light);
            background: var(--bg-card);
            color: var(--text-primary);
            transition: all var(--transition);
        }
        .wiz-nav-btn:hover {
            background: var(--bg-secondary);
            transform: translateY(-1px);
        }
        .wiz-nav-btn.primary {
            background: var(--accent);
            color: #fff;
            border-color: var(--accent);
            box-shadow: 0 2px 8px rgba(196, 101, 58, 0.25);
        }
        .wiz-nav-btn.primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }
        .wiz-nav-btn.generate {
            background: var(--green);
            color: #fff;
            border-color: var(--green);
            box-shadow: 0 2px 8px rgba(91, 140, 90, 0.25);
            font-size: 14px;
            padding: 14px 32px;
        }
        .wiz-nav-btn.generate:hover {
            background: var(--green-text);
            transform: translateY(-1px);
        }
        /* Results */
        .wizard-results {
            margin-top: 36px;
            padding-top: 36px;
            border-top: 2px solid var(--accent);
        }
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            flex-wrap: wrap;
            gap: 16px;
        }
        .results-header h3 {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .results-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .result-section-title {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 28px 0 16px;
        }
        .radar-container {
            display: flex;
            justify-content: center;
            margin: 20px 0 32px;
        }
        .sku-card {
            display: inline-block;
            width: calc(50% - 8px);
            padding: 24px;
            border-radius: var(--radius-md);
            margin-bottom: 16px;
            vertical-align: top;
        }
        .sku-card:first-of-type { margin-right: 12px; }
        .sku-card h4 {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .sku-card.dev {
            background: var(--orange-bg);
            border: 1px solid rgba(196, 136, 58, 0.2);
        }
        .sku-card.dev h4 { color: var(--orange-text); }
        .sku-card.prod {
            background: var(--green-bg);
            border: 1px solid rgba(91, 140, 90, 0.2);
        }
        .sku-card.prod h4 { color: var(--green-text); }
        .sku-name {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 36px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        .sku-card p {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        .risk-flag {
            padding: 14px 20px;
            background: var(--yellow-bg);
            border: 1px solid rgba(125, 106, 46, 0.2);
            border-radius: var(--radius-sm);
            font-size: 13px;
            color: var(--yellow-text);
            margin-bottom: 24px;
        }
        .budget-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 13px;
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            overflow: hidden;
            background: var(--bg-card);
            margin-bottom: 12px;
        }
        .budget-table th {
            background: var(--bg-secondary);
            padding: 12px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-light);
        }
        .budget-table td {
            padding: 12px 18px;
            border-bottom: 1px solid var(--border-subtle);
            color: var(--text-primary);
        }
        .budget-table tr:last-child td { border-bottom: none; }
        .budget-table tr:hover { background: var(--accent-soft); }

        /* ---- Validation Cards ---- */
        .validation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }
        .validation-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            padding: 20px 22px;
            transition: all var(--transition);
        }
        .validation-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        .validation-card:last-child:nth-child(odd) {
            grid-column: 1 / -1;
        }
        .validation-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .validation-card-title {
            font-size: 13px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .validation-card-title .vc-icon { font-size: 18px; }
        .fit-tag {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 980px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }
        .fit-strong {
            background: var(--green-bg);
            color: var(--green-text);
        }
        .fit-moderate {
            background: var(--yellow-bg);
            color: var(--yellow-text);
        }
        .fit-review {
            background: var(--red-bg);
            color: var(--red-text);
        }
        .validation-answer {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-bottom: 8px;
            font-weight: 500;
        }
        .validation-answer strong {
            color: var(--text-secondary);
        }
        .validation-rationale {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .validation-summary {
            background: var(--bg-card);
            border: 1.5px solid var(--accent);
            border-radius: var(--radius-md);
            padding: 20px 24px;
            margin-bottom: 28px;
        }
        .validation-summary p {
            font-size: 14px;
            color: var(--text-primary);
            line-height: 1.7;
        }
        @media (max-width: 768px) {
            .validation-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ---- Print ---- */
        @media print {
            .nav-buttons { display: none; }
            .nav-btn { display: none !important; }
            .search-container { display: none; }
            .brand-header { border-bottom: 1px solid #ccc; }
            body { padding: 24px; background: #fff; }
            .section-divider { page-break-before: always; }
            .stat-card { box-shadow: none; border: 1px solid #ddd; }
            .stat-card:hover { transform: none; }
            .legend-box { box-shadow: none; }
            .category-header, .category-header.alt {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .benefit-high, .benefit-mid, .benefit-low, .vtype-tag, .effort-tag {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }

        /* ---- Responsive ---- */
        @media (max-width: 768px) {
            body { padding: 24px 20px; }
            h1 { font-size: 26px; }
            .summary-stats { gap: 20px; }
            .matrix-stats { gap: 10px; }
            .stat-card { min-width: 90px; padding: 14px 12px; }
            .legend-container { flex-direction: column; }
            td, th { padding: 10px 12px; font-size: 12px; }
        }

    </style>
</head>
<body>
    <div class="container">

        <!-- Brand Header -->
        <div class="brand-header">
            <img class="fabric-logo" src="data:image/png;base64,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" alt="Microsoft Fabric" width="40" height="40">
            <div class="brand-text">
                <span class="brand-label">Microsoft Fabric</span>
                <span class="brand-author">Content Author: By Shrikesh Pattni</span>
            </div>
        </div>

        <h1>48 Proven Approaches to Optimising Microsoft Fabric Compute Costs</h1>
        <p class="subtitle">A comprehensive reference guide with Microsoft Learn sources and benefit ratings</p>

        <!-- Navigation -->
        <div class="nav-buttons">
            <a href="#recommendations" class="nav-btn nav-btn-primary">ðŸ“‹ Recommendations & Sources</a>
            <a href="#matrix" class="nav-btn nav-btn-outline">ðŸ“Š Value & Effort Matrix</a>
            <a href="#metadata" class="nav-btn nav-btn-outline">ðŸ”§ Fabric Metadata Automation</a>
            <a href="#fsku" class="nav-btn nav-btn-outline">ðŸŽ¯ F-SKU Capacity Assessment</a>
        </div>

        <!-- Search -->
        <div class="search-container">
            <div class="search-wrapper">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                <input type="text" class="search-input" id="searchInput" placeholder="Search recommendationsâ€¦ e.g. &quot;pause resume&quot;, &quot;Delta&quot;, &quot;throttling&quot;" autocomplete="off">
                <kbd class="search-kbd" id="searchKbd">ESC to clear</kbd>
            </div>
            <div class="search-results" id="searchResults"></div>
        </div>

        <!-- ========================================== -->
        <!-- SECTION 1: Recommendations & Sources       -->
        <!-- ========================================== -->
        <div id="recommendations" class="recs-section">

        <div class="summary-box">
            <h3>Guide Overview</h3>
            <div class="summary-stats">
                <div class="stat">
                    <div class="stat-number">48</div>
                    <div class="stat-label">Total Recommendations</div>
                </div>
                <div class="stat">
                    <div class="stat-number">6</div>
                    <div class="stat-label">Categories</div>
                </div>
                <div class="stat">
                    <div class="stat-number">22</div>
                    <div class="stat-label">High Impact Items</div>
                </div>
                <div class="stat">
                    <div class="stat-number">18</div>
                    <div class="stat-label">Medium Impact Items</div>
                </div>
            </div>
        </div>

        <div class="category-section">
            <div class="category-header">1. Capacity Management (Items #1â€“8)</div>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Recommendation</th>
                        <th>Source</th>
                        <th>Benefit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>#1</td>
                        <td>Implement automated pause/resume schedules for non-production capacities using Azure Automation or Logic Apps</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/pause-resume" target="_blank">Pause and resume your capacity</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#2</td>
                        <td>Right-size capacity SKUs based on actual CU consumption patterns observed in the Metrics App</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/capacity-planning-manage-capacity-growth-governance" target="_blank">Capacity Planning Guide</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#3</td>
                        <td>Use the Microsoft Fabric Capacity Metrics App daily to monitor utilisation trends and identify cost drivers</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app" target="_blank">Capacity Metrics App</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#4</td>
                        <td>Separate dev/test workloads from production capacities to enable independent pause/resume schedules</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/capacity-planning-manage-capacity-growth-governance" target="_blank">Capacity Planning Guide</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#5</td>
                        <td>Enable smoothing to avoid throttling spikes and benefit from 24-hour background operation distribution</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/throttling" target="_blank">Understand Throttling</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#6</td>
                        <td>Schedule heavy workloads (refreshes, ETL) during off-peak hours to avoid interactive operation conflicts</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app-compute-page" target="_blank">Metrics App Compute Page</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#7</td>
                        <td>Use Azure Logic Apps or Automation to implement dynamic capacity scaling based on time or workload triggers</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/pause-resume" target="_blank">Pause and resume your capacity</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#8</td>
                        <td>Monitor background vs interactive CU consumption separately to understand true workload distribution</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app-timepoint-page" target="_blank">Metrics App Timepoint Page</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="category-section">
            <div class="category-header alt">2. Notebook Optimisation (Items #9â€“16)</div>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Recommendation</th>
                        <th>Source</th>
                        <th>Benefit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>#9</td>
                        <td>Use High Concurrency mode to share Spark sessions across multiple notebooks â€” only the initiating session is billed</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/high-concurrency-overview" target="_blank">High Concurrency Mode Overview</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#10</td>
                        <td>Configure appropriate Spark pool sizes â€” avoid over-provisioning nodes beyond workload requirements</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/workspace-admin-settings" target="_blank">Workspace Admin Settings</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#11</td>
                        <td>Enable V-Order on Delta tables for read-heavy workloads to achieve faster query performance</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/delta-optimization-and-v-order" target="_blank">Delta Optimization and V-Order</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#12</td>
                        <td>Use .cache() strategically â€” only on DataFrames accessed multiple times; unpersist when done</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/spark-best-practices-development-monitoring" target="_blank">Spark Best Practices</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#13</td>
                        <td>Prefer df.filter() before df.select() to reduce data volume early in the transformation chain</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/spark-best-practices-development-monitoring" target="_blank">Spark Best Practices</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#14</td>
                        <td>Avoid collect() on large datasets â€” use display() with limits or write to Delta for downstream analysis</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/how-to-use-notebook" target="_blank">How to Use Notebooks</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#15</td>
                        <td>Set appropriate shuffle partitions (spark.sql.shuffle.partitions) based on data volume â€” default 200 may be excessive</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/spark-best-practices-development-monitoring" target="_blank">Spark Best Practices</a></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#16</td>
                        <td>Use broadcast joins for small dimension tables to avoid expensive shuffle operations</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/spark-best-practices-development-monitoring" target="_blank">Spark Best Practices</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>


        <div class="page-break"></div>

        <div class="category-section">
            <div class="category-header">3. Dataflow Gen2 vs Notebooks Decision Framework (Items #17â€“24)</div>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Recommendation</th>
                        <th>Source</th>
                        <th>Benefit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>#17</td>
                        <td>Use Dataflow Gen2 for simple ETL workloads under 1M rows where Power Query transformations are sufficient</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/fundamentals/decision-guide-pipeline-dataflow-spark" target="_blank">Decision Guide: Pipeline, Dataflow, Spark</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#18</td>
                        <td>Use Notebooks for complex transformations over 1M rows where Spark's distributed computing is beneficial</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/decision-guide-data-integration" target="_blank">Data Integration Decision Guide</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#19</td>
                        <td>Avoid Dataflow Gen2 for iterative/looping logic â€” Notebooks handle procedural patterns more efficiently</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/dataflow-gen2-performance-best-practices" target="_blank">Dataflow Gen2 Performance Best Practices</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#20</td>
                        <td>Use Notebooks when joining 3+ large tables â€” Spark optimises join strategies better than Mashup engine</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/decision-guide-data-integration" target="_blank">Data Integration Decision Guide</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#21</td>
                        <td>Prefer Dataflow Gen2 for citizen developer scenarios where no-code visual interface is required</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/dataflows-gen2-overview" target="_blank">Dataflow Gen2 Overview</a></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#22</td>
                        <td>Use Notebooks when you need explicit partitioning control or custom Delta table maintenance</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/lakehouse-table-maintenance" target="_blank">Lakehouse Table Maintenance</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#23</td>
                        <td>Dataflow Gen2 staging Lakehouse adds CU overhead â€” disable staging if transformations fold to source</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/pricing-dataflows-gen2" target="_blank">Dataflow Gen2 Pricing</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#24</td>
                        <td>Use Copy Activity for simple data movement without transformation â€” lower CU cost than Dataflow Gen2</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/decision-guide-data-transformation" target="_blank">Data Transformation Decision Guide</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="category-section">
            <div class="category-header alt">4. Delta Table & Lakehouse Design (Items #25â€“32)</div>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Recommendation</th>
                        <th>Source</th>
                        <th>Benefit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>#25</td>
                        <td>Partition large tables by date or region â€” avoid high-cardinality columns that create too many small files</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/delta-optimization-and-v-order" target="_blank">Delta Optimization and V-Order</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#26</td>
                        <td>Run OPTIMIZE regularly on frequently queried tables to compact small files into larger ones</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/table-compaction" target="_blank">Table Compaction</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#27</td>
                        <td>Use VACUUM to remove old files no longer referenced â€” default retention is 7 days, balance with time travel needs</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/lakehouse-table-maintenance" target="_blank">Lakehouse Table Maintenance</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#28</td>
                        <td>Enable Z-Order on common filter columns to improve file skipping for analytical queries</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/table-compaction" target="_blank">Table Compaction</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#29</td>
                        <td>Use Delta table time travel sparingly â€” each version increases storage costs in OneLake</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/lakehouse-and-delta-tables" target="_blank">Lakehouse and Delta Tables</a></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#30</td>
                        <td>Prefer CTAS (CREATE TABLE AS SELECT) over INSERT for bulk loads to reduce transaction log overhead</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-warehouse/guidelines-warehouse-performance" target="_blank">Warehouse Performance Guidelines</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#31</td>
                        <td>Use incremental refresh patterns â€” avoid full table reloads where change detection is possible</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/fundamentals/direct-lake-understand-storage" target="_blank">Direct Lake Query Performance</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#32</td>
                        <td>Separate bronze/silver/gold into distinct Lakehouses for governance and independent maintenance schedules</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/lakehouse-and-delta-tables" target="_blank">Lakehouse and Delta Tables</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>


        <div class="page-break"></div>

        <div class="category-section">
            <div class="category-header">5. Pipeline & Orchestration (Items #33â€“40)</div>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Recommendation</th>
                        <th>Source</th>
                        <th>Benefit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>#33</td>
                        <td>Use pipeline parameters to avoid duplicating pipelines â€” create reusable templates with dynamic values</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/notebook-activity" target="_blank">Notebook Activity in Pipelines</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#34</td>
                        <td>Set appropriate concurrency limits on ForEach loops to prevent capacity exhaustion</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/spark-job-concurrency-and-queueing" target="_blank">Spark Job Concurrency</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#35</td>
                        <td>Use Until loops with max iteration limits to prevent runaway execution costs</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/notebook-activity" target="_blank">Notebook Activity in Pipelines</a></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#36</td>
                        <td>Implement retry policies with exponential backoff to handle transient failures efficiently</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/notebook-activity" target="_blank">Notebook Activity in Pipelines</a></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#37</td>
                        <td>Use pipeline variables over repeated lookup activities to reduce unnecessary compute operations</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/notebook-utilities" target="_blank">NotebookUtils</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#38</td>
                        <td>Chain notebooks in pipelines with session tags â€” don't call notebooks from within notebooks</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-engineering/configure-high-concurrency-session-notebooks-in-pipelines" target="_blank">High Concurrency in Pipelines</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#39</td>
                        <td>Schedule pipelines sequentially if they compete for the same CUs â€” avoid parallel execution during peak times</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/throttling" target="_blank">Understand Throttling</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#40</td>
                        <td>Use event-based triggers over scheduled triggers where possible â€” only execute when data arrives</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/data-factory/notebook-activity" target="_blank">Notebook Activity in Pipelines</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="category-section">
            <div class="category-header alt">6. Monitoring & Governance (Items #41â€“48)</div>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Recommendation</th>
                        <th>Source</th>
                        <th>Benefit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>#41</td>
                        <td>Use the Fabric Capacity Metrics app as your daily operational dashboard for capacity health</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app" target="_blank">Capacity Metrics App</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#42</td>
                        <td>Tag workloads with workspace naming conventions for cost allocation and chargeback reporting</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/capacity-planning-manage-capacity-growth-governance" target="_blank">Capacity Planning Guide</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#43</td>
                        <td>Set up alerts for capacity utilisation thresholds (e.g., 80%) to proactively prevent throttling</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/capacity-planning-troubleshoot-consumption" target="_blank">Troubleshoot Consumption</a></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#44</td>
                        <td>Review Admin API exports for usage patterns and identify opportunities for automation</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/fabric-operations" target="_blank">Fabric Operations</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#45</td>
                        <td>Audit unused datasets and reports monthly â€” orphaned items still consume storage and may trigger refreshes</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/azure-billing" target="_blank">Understand Azure Bill</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#46</td>
                        <td>Implement workspace-level access controls to prevent uncontrolled workspace sprawl</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/capacity-planning-manage-capacity-growth-governance" target="_blank">Capacity Planning Guide</a></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#47</td>
                        <td>Document data refresh dependencies to identify redundant or cascading refreshes</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app-compute-page" target="_blank">Metrics App Compute Page</a></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#48</td>
                        <td>Use Microsoft Purview lineage to track data flow, identify waste, and understand downstream impact</td>
                        <td><a href="https://learn.microsoft.com/en-us/fabric/get-started/delta-lake-interoperability" target="_blank">Delta Lake Interoperability</a></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                </tbody>
            </table>
        </div>


        </div>

        <!-- ========================================== -->
        <!-- SECTION 2: Value & Effort Matrix           -->
        <!-- ========================================== -->
        <div class="section-divider" id="matrix">
            <h2>ðŸ“Š Value & Effort Matrix</h2>
            <p>Prioritise optimisation efforts by understanding the type of value each recommendation delivers and the effort required to implement it</p>
            <a href="#recommendations" class="nav-btn nav-btn-outline" style="margin-top:8px;">â†‘ Back to Recommendations & Sources</a>
        </div>

        <div class="matrix-section">

            <!-- Summary stats -->
            <div class="matrix-stats">
                <div class="stat-card">
                    <div class="sc-number">21</div>
                    <div class="sc-label">ðŸš€ Quick Wins</div>
                </div>
                <div class="stat-card">
                    <div class="sc-number">22</div>
                    <div class="sc-label">ðŸ”§ Moderate Effort</div>
                </div>
                <div class="stat-card">
                    <div class="sc-number">5</div>
                    <div class="sc-label">ðŸ—ï¸ Investment</div>
                </div>
                <div class="stat-card">
                    <div class="sc-number">29</div>
                    <div class="sc-label">âš¡ CU Reduction</div>
                </div>
                <div class="stat-card">
                    <div class="sc-number">17</div>
                    <div class="sc-label">ðŸ›¡ï¸ Cost Avoidance</div>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend-container">
                <div class="legend-box">
                    <h3>Value Types</h3>
                    <div class="legend-item"><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span>â€” Directly lowers compute consumption</span> <span class="legend-count">29</span></div>
                    <div class="legend-item"><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span> <span>â€” Prevents unnecessary spend before it happens</span> <span class="legend-count">17</span></div>
                    <div class="legend-item"><span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span> <span>â€” Protects performance under load</span> <span class="legend-count">7</span></div>
                    <div class="legend-item"><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span> <span>â€” Reduces manual effort, improves workflow</span> <span class="legend-count">13</span></div>
                </div>
                <div class="legend-box">
                    <h3>Effort Levels</h3>
                    <div class="legend-item"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span> <span>â€” Config change or toggle, minimal dev time</span> <span class="legend-count">21</span></div>
                    <div class="legend-item"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span> <span>â€” Requires some development or testing</span> <span class="legend-count">22</span></div>
                    <div class="legend-item"><span class="effort-tag" style="color:var(--red-text);background:var(--red-bg);">ðŸ—ï¸ Investment</span> <span>â€” Architectural change, needs planning</span> <span class="legend-count">5</span></div>
                </div>
            </div>

        <div class="category-section">
            <div class="category-header">1. Capacity Management (Items #1â€“8)</div>
            <table>
                <thead><tr>
                    <th style="width:4%;">#</th>
                    <th style="width:36%;">Recommendation</th>
                    <th style="width:26%;">Value Type</th>
                    <th style="width:12%;">Effort</th>
                    <th style="width:10%;">Benefit</th>
                </tr></thead>
                <tbody>
                    <tr>
                        <td>#1</td>
                        <td>Implement automated pause/resume schedules for non-production capacities using Azure Automation or Logic Apps</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span> <span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#2</td>
                        <td>Right-size capacity SKUs based on actual CU consumption patterns observed in the Metrics App</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#3</td>
                        <td>Use the Microsoft Fabric Capacity Metrics App daily to monitor utilisation trends and identify cost drivers</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#4</td>
                        <td>Separate dev/test workloads from production capacities to enable independent pause/resume schedules</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span> <span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--red-text);background:var(--red-bg);">ðŸ—ï¸ Investment</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#5</td>
                        <td>Enable smoothing to avoid throttling spikes and benefit from 24-hour background operation distribution</td>
                        <td><span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#6</td>
                        <td>Schedule heavy workloads (refreshes, ETL) during off-peak hours to avoid interactive operation conflicts</td>
                        <td><span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span> <span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#7</td>
                        <td>Use Azure Logic Apps or Automation to implement dynamic capacity scaling based on time or workload triggers</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span> <span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#8</td>
                        <td>Monitor background vs interactive CU consumption separately to understand true workload distribution</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="category-section">
            <div class="category-header alt">2. Notebook Optimisation (Items #9â€“16)</div>
            <table>
                <thead><tr>
                    <th style="width:4%;">#</th>
                    <th style="width:36%;">Recommendation</th>
                    <th style="width:26%;">Value Type</th>
                    <th style="width:12%;">Effort</th>
                    <th style="width:10%;">Benefit</th>
                </tr></thead>
                <tbody>
                    <tr>
                        <td>#9</td>
                        <td>Use High Concurrency mode to share Spark sessions across multiple notebooks â€” only the initiating session consumes full CUs</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#10</td>
                        <td>Configure appropriate Spark pool sizes â€” avoid over-provisioning nodes beyond workload requirements</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#11</td>
                        <td>Enable V-Order on Delta tables for read-heavy workloads to achieve faster query performance</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#12</td>
                        <td>Use .cache() strategically â€” only on DataFrames accessed multiple times; unpersist when done</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#13</td>
                        <td>Prefer df.filter() before df.select() to reduce data volume early in the transformation chain</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#14</td>
                        <td>Avoid collect() on large datasets â€” use display() with limits or write to Delta for downstream analysis</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#15</td>
                        <td>Set appropriate shuffle partitions (spark.sql.shuffle.partitions) based on data volume â€” default 200 may not be optimal</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#16</td>
                        <td>Use broadcast joins for small dimension tables to avoid expensive shuffle operations</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="page-break"></div>

        <div class="category-section">
            <div class="category-header">3. Dataflow vs Notebook Selection (Items #17â€“24)</div>
            <table>
                <thead><tr>
                    <th style="width:4%;">#</th>
                    <th style="width:36%;">Recommendation</th>
                    <th style="width:26%;">Value Type</th>
                    <th style="width:12%;">Effort</th>
                    <th style="width:10%;">Benefit</th>
                </tr></thead>
                <tbody>
                    <tr>
                        <td>#17</td>
                        <td>Use Dataflow Gen2 for simple ETL workloads under 1M rows where Power Query transformations are sufficient</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#18</td>
                        <td>Use Notebooks for complex transformations over 1M rows where Sparkâ€™s distributed computing is beneficial</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#19</td>
                        <td>Avoid Dataflow Gen2 for iterative/looping logic â€” Notebooks handle procedural patterns more efficiently</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#20</td>
                        <td>Use Notebooks when joining 3+ large tables â€” Spark optimises join strategies better than Mashup engine</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#21</td>
                        <td>Prefer Dataflow Gen2 for citizen developer scenarios where no-code visual interface is required</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#22</td>
                        <td>Use Notebooks when you need explicit partitioning control or custom Delta table maintenance</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#23</td>
                        <td>Dataflow Gen2 staging Lakehouse adds CU overhead â€” disable staging if transformations fold to source</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#24</td>
                        <td>Use Copy Activity for simple data movement without transformation â€” lower CU cost than Dataflow Gen2</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="category-section">
            <div class="category-header alt">4. Delta & Lakehouse Design (Items #25â€“32)</div>
            <table>
                <thead><tr>
                    <th style="width:4%;">#</th>
                    <th style="width:36%;">Recommendation</th>
                    <th style="width:26%;">Value Type</th>
                    <th style="width:12%;">Effort</th>
                    <th style="width:10%;">Benefit</th>
                </tr></thead>
                <tbody>
                    <tr>
                        <td>#25</td>
                        <td>Partition large tables by date or region â€” avoid high-cardinality columns that create too many small files</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--red-text);background:var(--red-bg);">ðŸ—ï¸ Investment</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#26</td>
                        <td>Run OPTIMIZE regularly on frequently queried tables to compact small files into larger ones</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#27</td>
                        <td>Use VACUUM to remove old files no longer referenced â€” default retention is 7 days, balance with time travel needs</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#28</td>
                        <td>Enable Z-Order on common filter columns to improve file skipping for analytical queries</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#29</td>
                        <td>Use Delta table time travel sparingly â€” each version increases storage costs in OneLake</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#30</td>
                        <td>Prefer CTAS (CREATE TABLE AS SELECT) over INSERT for bulk loads to reduce transaction log overhead</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#31</td>
                        <td>Use incremental refresh patterns â€” avoid full table reloads where change detection is possible</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--red-text);background:var(--red-bg);">ðŸ—ï¸ Investment</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#32</td>
                        <td>Separate bronze/silver/gold into distinct Lakehouses for governance and independent maintenance schedules</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--red-text);background:var(--red-bg);">ðŸ—ï¸ Investment</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="page-break"></div>

        <div class="category-section">
            <div class="category-header">5. Pipeline & Orchestration (Items #33â€“40)</div>
            <table>
                <thead><tr>
                    <th style="width:4%;">#</th>
                    <th style="width:36%;">Recommendation</th>
                    <th style="width:26%;">Value Type</th>
                    <th style="width:12%;">Effort</th>
                    <th style="width:10%;">Benefit</th>
                </tr></thead>
                <tbody>
                    <tr>
                        <td>#33</td>
                        <td>Use pipeline parameters to avoid duplicating pipelines â€” create reusable templates with dynamic values</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#34</td>
                        <td>Set appropriate concurrency limits on ForEach loops to prevent capacity exhaustion</td>
                        <td><span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span> <span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#35</td>
                        <td>Use Until loops with max iteration limits to prevent runaway execution costs</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#36</td>
                        <td>Implement retry policies with exponential backoff to handle transient failures efficiently</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#37</td>
                        <td>Use pipeline variables over repeated lookup activities to reduce unnecessary compute operations</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#38</td>
                        <td>Chain notebooks in pipelines with session tags â€” donâ€™t call notebooks from within notebooks</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#39</td>
                        <td>Schedule pipelines sequentially if they compete for the same CUs â€” avoid parallel execution during peak times</td>
                        <td><span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#40</td>
                        <td>Use event-based triggers over scheduled triggers where possible â€” only execute when data arrives</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="category-section">
            <div class="category-header alt">6. Monitoring & Governance (Items #41â€“48)</div>
            <table>
                <thead><tr>
                    <th style="width:4%;">#</th>
                    <th style="width:36%;">Recommendation</th>
                    <th style="width:26%;">Value Type</th>
                    <th style="width:12%;">Effort</th>
                    <th style="width:10%;">Benefit</th>
                </tr></thead>
                <tbody>
                    <tr>
                        <td>#41</td>
                        <td>Use the Fabric Capacity Metrics app as your daily operational dashboard for capacity health</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span> <span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#42</td>
                        <td>Tag workloads with workspace naming conventions for cost allocation and chargeback reporting</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#43</td>
                        <td>Set up alerts for capacity utilisation thresholds (e.g., 80%) to proactively prevent throttling</td>
                        <td><span class="vtype-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">âš ï¸ Throttling Prevention</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-high">HIGH</span></td>
                    </tr>
                    <tr>
                        <td>#44</td>
                        <td>Review Admin API exports for usage patterns and identify opportunities for automation</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#45</td>
                        <td>Audit unused datasets and reports monthly â€” orphaned items still consume storage and may trigger refreshes</td>
                        <td><span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#46</td>
                        <td>Implement workspace-level access controls to prevent uncontrolled workspace sprawl</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--green-text);background:var(--green-bg);">ðŸš€ Quick Win</span></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>#47</td>
                        <td>Document data refresh dependencies to identify redundant or cascading refreshes</td>
                        <td><span class="vtype-tag" style="color:var(--green-text);background:var(--green-bg);">âš¡ CU Reduction</span> <span class="vtype-tag" style="color:var(--blue-text);background:var(--blue-bg);">ðŸ›¡ï¸ Cost Avoidance</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--yellow-text);background:var(--yellow-bg);">ðŸ”§ Moderate</span></td>
                        <td><span class="benefit-mid">MID</span></td>
                    </tr>
                    <tr>
                        <td>#48</td>
                        <td>Use Microsoft Purview lineage to track data flow, identify waste, and understand downstream impact</td>
                        <td><span class="vtype-tag" style="color:var(--peach-text);background:var(--peach-bg);">âš™ï¸ Operational Efficiency</span></td>
                        <td style="text-align:center;"><span class="effort-tag" style="color:var(--red-text);background:var(--red-bg);">ðŸ—ï¸ Investment</span></td>
                        <td><span class="benefit-low">LOW</span></td>
                    </tr>
                </tbody>
            </table>
        </div>


        </div>

        <!-- ========================================== -->
        <!-- SECTION 3: Fabric Metadata Automation     -->
        <!-- ========================================== -->
        <div class="section-divider" id="metadata">
            <h2>ðŸ”§ Fabric Metadata Extraction Automation</h2>
            <p>Automated governance scanning using the Fabric Admin REST API and Scanner API â€” producing a complete tenant inventory as structured CSV outputs</p>
            <a href="#recommendations" class="nav-btn nav-btn-outline" style="margin-top:8px;">â†‘ Back to top</a>
        </div>

        <div class="metadata-section">

            <!-- Process overview cards -->
            <div class="matrix-stats">
                <div class="stat-card">
                    <div class="sc-number">16</div>
                    <div class="sc-label">ðŸ“„ CSV Outputs</div>
                </div>
                <div class="stat-card">
                    <div class="sc-number">4</div>
                    <div class="sc-label">ðŸ”— API Categories</div>
                </div>
                <div class="stat-card">
                    <div class="sc-number">6</div>
                    <div class="sc-label">âš™ï¸ Tenant Settings</div>
                </div>
                <div class="stat-card">
                    <div class="sc-number">5</div>
                    <div class="sc-label">ðŸ—ï¸ Process Groups</div>
                </div>
            </div>

            <!-- Group 1: Workspace & Item Inventory -->
            <div class="category-section">
                <div class="category-header">1. Workspace & Item Inventory</div>
                <table>
                    <thead><tr>
                        <th style="width:4%;">#</th>
                        <th style="width:22%;">Output File</th>
                        <th style="width:34%;">Description</th>
                        <th style="width:22%;">API Endpoint</th>
                        <th style="width:18%;">Source</th>
                    </tr></thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td><code>workspaces.csv</code></td>
                            <td>Complete workspace inventory across the tenant â€” name, ID, state, type, capacity assignment, and default dataset storage format</td>
                            <td><code>/admin/groups</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/groups-get-groups-as-admin" target="_blank">Get Groups As Admin</a></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><code>all_items_core.csv</code></td>
                            <td>Core item inventory â€” every dataset, report, dashboard, dataflow, and notebook across all workspaces with item type, ID, and workspace mapping</td>
                            <td><code>/admin/workspaces/getInfo</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/workspace-info-post-workspace-info" target="_blank">Scanner API â€” Post Workspace Info</a></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><code>all_items_full_details.csv</code></td>
                            <td>Extended item metadata â€” includes configured data sources, endorsement status, sensitivity labels, descriptions, and last modified timestamps</td>
                            <td><code>/admin/workspaces/scanResult</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/workspace-info-get-scan-result" target="_blank">Scanner API â€” Get Scan Result</a></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><code>items_by_type_summary.csv</code></td>
                            <td>Aggregated item counts grouped by artifact type (Dataset, Report, Dashboard, Dataflow, Notebook, etc.) â€” derived from Scanner API output</td>
                            <td><code>/admin/workspaces/scanResult</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/governance/metadata-scanning-overview" target="_blank">Metadata Scanning Overview</a></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><code>items_by_workspace_summary.csv</code></td>
                            <td>Item counts aggregated by workspace â€” shows content density per workspace for sprawl detection and governance prioritisation</td>
                            <td><code>/admin/workspaces/scanResult</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/governance/metadata-scanning-overview" target="_blank">Metadata Scanning Overview</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Group 2: Capacity & Paid Resource Tracking -->
            <div class="category-section">
                <div class="category-header alt">2. Capacity & Paid Resource Tracking</div>
                <table>
                    <thead><tr>
                        <th style="width:4%;">#</th>
                        <th style="width:22%;">Output File</th>
                        <th style="width:34%;">Description</th>
                        <th style="width:22%;">API Endpoint</th>
                        <th style="width:18%;">Source</th>
                    </tr></thead>
                    <tbody>
                        <tr>
                            <td>6</td>
                            <td><code>capacity_summary.csv</code></td>
                            <td>All capacities in the tenant â€” SKU, state, region, admins, and capacity ID. Essential for mapping workspaces to billing units</td>
                            <td><code>/admin/capacities</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/get-capacities-as-admin" target="_blank">Get Capacities As Admin</a></td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td><code>capacity_workspace_governance.csv</code></td>
                            <td>Workspace-to-capacity mapping with governance metadata â€” links each workspace to its capacity for cost allocation and chargeback reporting</td>
                            <td><code>/admin/groups</code> + <code>/admin/capacities</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/groups-get-groups-as-admin" target="_blank">Get Groups As Admin</a></td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td><code>paid_capacity_items.csv</code></td>
                            <td>Filtered list of items running exclusively on paid (non-trial) capacities â€” identifies what is actually consuming licensed CUs</td>
                            <td><code>/admin/workspaces/scanResult</code> + capacity filter</td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/licenses" target="_blank">Fabric Licences</a></td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td><code>paid_capacity_type_summary.csv</code></td>
                            <td>Paid capacity item counts broken down by artifact type â€” shows the distribution of compute-consuming items across datasets, reports, notebooks, etc.</td>
                            <td>Derived from scan + capacity filter</td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/capacity-planning-manage-capacity-growth-governance" target="_blank">Capacity Planning Guide</a></td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td><code>paid_capacity_workspace_summary.csv</code></td>
                            <td>Paid capacity usage aggregated by workspace â€” enables workspace-level cost attribution and identifies highest-consumption workspaces</td>
                            <td>Derived from scan + capacity filter</td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app" target="_blank">Capacity Metrics App</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Group 3: Semantic Model Metadata -->
            <div class="category-section">
                <div class="category-header">3. Semantic Model Metadata</div>
                <table>
                    <thead><tr>
                        <th style="width:4%;">#</th>
                        <th style="width:22%;">Output File</th>
                        <th style="width:34%;">Description</th>
                        <th style="width:22%;">API Endpoint</th>
                        <th style="width:18%;">Source</th>
                    </tr></thead>
                    <tbody>
                        <tr>
                            <td>11</td>
                            <td><code>semantic_models.csv</code></td>
                            <td>Full semantic model inventory â€” name, ID, configured by, data sources, endorsement, storage mode, and workspace assignment</td>
                            <td><code>/admin/datasets</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/datasets-get-datasets-as-admin" target="_blank">Get Datasets As Admin</a></td>
                        </tr>
                        <tr>
                            <td>12</td>
                            <td><code>semantic_model_ids.csv</code></td>
                            <td>Lightweight reference list of semantic model IDs mapped to names and workspaces â€” used as a lookup table for downstream joins and enrichment</td>
                            <td><code>/admin/datasets</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/datasets-get-datasets-as-admin" target="_blank">Get Datasets As Admin</a></td>
                        </tr>
                        <tr>
                            <td>13</td>
                            <td><code>semantic_models_by_workspace.csv</code></td>
                            <td>Semantic models grouped and counted by workspace â€” identifies workspace-level model density for governance review and rationalisation</td>
                            <td><code>/admin/datasets</code> + workspace join</td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/governance/metadata-scanning-overview" target="_blank">Metadata Scanning Overview</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Group 4: User & Access Governance -->
            <div class="category-section">
                <div class="category-header alt">4. User & Access Governance</div>
                <table>
                    <thead><tr>
                        <th style="width:4%;">#</th>
                        <th style="width:22%;">Output File</th>
                        <th style="width:34%;">Description</th>
                        <th style="width:22%;">API Endpoint</th>
                        <th style="width:18%;">Source</th>
                    </tr></thead>
                    <tbody>
                        <tr>
                            <td>14</td>
                            <td><code>workspace_users.csv</code></td>
                            <td>User membership per workspace â€” lists every user/group with their assigned role (Admin, Member, Contributor, Viewer) per workspace</td>
                            <td><code>/admin/groups/{id}/users</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin/groups-get-group-users-as-admin" target="_blank">Get Group Users As Admin</a></td>
                        </tr>
                        <tr>
                            <td>15</td>
                            <td><code>workspace_access_summary.csv</code></td>
                            <td>Workspace-level access summary â€” aggregated role counts per workspace to identify over-permissioned or under-governed workspaces</td>
                            <td><code>/admin/groups/{id}/users</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/power-bi/collaborate-share/service-roles-new-workspaces" target="_blank">Workspace Roles</a></td>
                        </tr>
                        <tr>
                            <td>16</td>
                            <td><code>user_access_summary.csv</code></td>
                            <td>User-centric access summary â€” aggregated view per user showing how many workspaces they have access to and at which role levels</td>
                            <td><code>/admin/groups/{id}/users</code> + pivot</td>
                            <td><a href="https://learn.microsoft.com/en-us/power-bi/guidance/powerbi-implementation-planning-security-tenant-level-planning" target="_blank">Tenant-Level Security Planning</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Group 5: Required Tenant Settings -->
            <div class="category-section">
                <div class="category-header">5. Required Tenant Settings for API Access</div>
                <table>
                    <thead><tr>
                        <th style="width:4%;">#</th>
                        <th style="width:30%;">Tenant Setting</th>
                        <th style="width:36%;">What It Enables</th>
                        <th style="width:30%;">Source</th>
                    </tr></thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td><strong>Allow service principals to use Power BI APIs</strong></td>
                            <td>Service principals can call Admin REST APIs without a delegated admin token â€” eliminates MFA issues for automation</td>
                            <td><a href="https://learn.microsoft.com/en-us/power-bi/enterprise/service-premium-service-principal" target="_blank">Service Principal for Admin APIs</a></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><strong>Allow service principals to use read-only admin APIs</strong></td>
                            <td>Service principals can call read-only Admin APIs (Scanner, Get Groups, Get Activity Events) â€” minimum for governance scanning</td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/admin/metadata-scanning-setup" target="_blank">Metadata Scanning Setup</a></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><strong>Enhance admin APIs responses with detailed metadata</strong></td>
                            <td>Enables model caching â€” Scanner API responses include table names, column names, measure names, and descriptions</td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/admin/metadata-scanning-setup" target="_blank">Metadata Scanning Setup</a></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><strong>Enhance admin APIs responses with DAX and mashup expressions</strong></td>
                            <td>Scanner responses include DAX measure expressions and Power Query M code â€” requires detailed metadata setting above</td>
                            <td><a href="https://learn.microsoft.com/en-us/fabric/admin/metadata-scanning-setup" target="_blank">Metadata Scanning Setup</a></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><strong>Service Principal security group assignment</strong></td>
                            <td>All API settings scoped to a specific security group (e.g. SG-PBI-ServicePrincipals) â€” never enable for entire organisation</td>
                            <td><a href="https://learn.microsoft.com/en-us/power-bi/guidance/powerbi-implementation-planning-security-tenant-level-planning" target="_blank">Tenant-Level Security Planning</a></td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td><strong>Client Credentials OAuth 2.0 flow</strong></td>
                            <td>Authenticate using App Registration + Client Secret â€” resource: <code>https://analysis.windows.net/powerbi/api</code></td>
                            <td><a href="https://learn.microsoft.com/en-us/rest/api/power-bi/admin" target="_blank">Power BI Admin REST API Reference</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div>

        <!-- ============================================ -->
        <!-- SECTION 4: F-SKU Decision Assessment         -->
        <!-- ============================================ -->
        <div class="section-divider" id="fsku">
            <h2>ðŸŽ¯ F-SKU Capacity Assessment</h2>
            <p>Interactive wizard â€” 25 questions across 5 stages producing a tailored F-SKU recommendation with radar profile</p>
            <a href="#recommendations" class="nav-btn nav-btn-outline" style="margin-top:8px;">â†‘ Back to top</a>
        </div>
        <div class="fsku-section">
            <div class="wizard-progress"><div class="wizard-progress-bar" id="wizardProgressBar"></div></div>
            <div class="wizard-progress-text" id="wizardProgressText">Stage 1 of 5</div>
            <div class="wizard-stages" id="wizardStages">
                <button class="wizard-stage-btn active" onclick="goToStage(0)" id="stageBtn0"><span class="stage-icon">ðŸ¢</span><span class="stage-label">Organisation Profile</span></button>
                <button class="wizard-stage-btn" onclick="goToStage(1)" id="stageBtn1"><span class="stage-icon">ðŸ—ï¸</span><span class="stage-label">Current Foundation</span></button>
                <button class="wizard-stage-btn" onclick="goToStage(2)" id="stageBtn2"><span class="stage-icon">ðŸ—„ï¸</span><span class="stage-label">Data Estate</span></button>
                <button class="wizard-stage-btn" onclick="goToStage(3)" id="stageBtn3"><span class="stage-icon">âš¡</span><span class="stage-label">Fabric Workloads</span></button>
                <button class="wizard-stage-btn" onclick="goToStage(4)" id="stageBtn4"><span class="stage-icon">ðŸ’°</span><span class="stage-label">Users & Budget</span></button>
            </div>
            <div class="wizard-panels" id="wizardPanels">
                <div class="wizard-panel" id="panel0">
                    <div class="panel-header"><span class="panel-icon">ðŸ¢</span><div><h3>Stage 1: Organisation Profile</h3><p>Scale, maturity, and operating context</p></div></div>
                    <div class="wizard-question"><div class="question-number">Q1</div><div class="question-text">How many employees does your organisation have?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q1_1" value="< 500" onchange="onAnswer()"><span class="chip-text">< 500</span></label>
                        <label class="option-chip"><input type="radio" name="q1_1" value="500â€“2,000" onchange="onAnswer()"><span class="chip-text">500â€“2,000</span></label>
                        <label class="option-chip"><input type="radio" name="q1_1" value="2,000â€“10,000" onchange="onAnswer()"><span class="chip-text">2,000â€“10,000</span></label>
                        <label class="option-chip"><input type="radio" name="q1_1" value="10,000â€“50,000" onchange="onAnswer()"><span class="chip-text">10,000â€“50,000</span></label>
                        <label class="option-chip"><input type="radio" name="q1_1" value="50,000+" onchange="onAnswer()"><span class="chip-text">50,000+</span></label>
                    </div><textarea class="wizard-notes" id="notes_q1_1" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q2</div><div class="question-text">How would you describe your organisation's data maturity?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q1_2" value="Ad-hoc (spreadsheets, no central platform)" onchange="onAnswer()"><span class="chip-text">Ad-hoc (spreadsheets, no central platform)</span></label>
                        <label class="option-chip"><input type="radio" name="q1_2" value="Reactive (some BI tools, limited governance)" onchange="onAnswer()"><span class="chip-text">Reactive (some BI tools, limited governance)</span></label>
                        <label class="option-chip"><input type="radio" name="q1_2" value="Managed (centralised platform, some governance)" onchange="onAnswer()"><span class="chip-text">Managed (centralised platform, some governance)</span></label>
                        <label class="option-chip"><input type="radio" name="q1_2" value="Optimised (well-governed, automated, CI/CD)" onchange="onAnswer()"><span class="chip-text">Optimised (well-governed, automated, CI/CD)</span></label>
                        <label class="option-chip"><input type="radio" name="q1_2" value="Advanced (data mesh, self-service with guardrails)" onchange="onAnswer()"><span class="chip-text">Advanced (data mesh, self-service with guardrails)</span></label>
                    </div><textarea class="wizard-notes" id="notes_q1_2" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q3</div><div class="question-text">What industry sector does your organisation operate in?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q1_3" value="Financial Services" onchange="onAnswer()"><span class="chip-text">Financial Services</span></label>
                        <label class="option-chip"><input type="radio" name="q1_3" value="Healthcare & Life Sciences" onchange="onAnswer()"><span class="chip-text">Healthcare & Life Sciences</span></label>
                        <label class="option-chip"><input type="radio" name="q1_3" value="Government & Public Sector" onchange="onAnswer()"><span class="chip-text">Government & Public Sector</span></label>
                        <label class="option-chip"><input type="radio" name="q1_3" value="Retail & Consumer Goods" onchange="onAnswer()"><span class="chip-text">Retail & Consumer Goods</span></label>
                        <label class="option-chip"><input type="radio" name="q1_3" value="Manufacturing & Energy" onchange="onAnswer()"><span class="chip-text">Manufacturing & Energy</span></label>
                        <label class="option-chip"><input type="radio" name="q1_3" value="Technology & Media" onchange="onAnswer()"><span class="chip-text">Technology & Media</span></label>
                        <label class="option-chip"><input type="radio" name="q1_3" value="Education & Non-Profit" onchange="onAnswer()"><span class="chip-text">Education & Non-Profit</span></label>
                        <label class="option-chip"><input type="radio" name="q1_3" value="Other" onchange="onAnswer()"><span class="chip-text">Other</span></label>
                    </div><textarea class="wizard-notes" id="notes_q1_3" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q4</div><div class="question-text">How many business units or departments will use Fabric?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q1_4" value="1 (single team)" onchange="onAnswer()"><span class="chip-text">1 (single team)</span></label>
                        <label class="option-chip"><input type="radio" name="q1_4" value="2â€“5" onchange="onAnswer()"><span class="chip-text">2â€“5</span></label>
                        <label class="option-chip"><input type="radio" name="q1_4" value="6â€“15" onchange="onAnswer()"><span class="chip-text">6â€“15</span></label>
                        <label class="option-chip"><input type="radio" name="q1_4" value="15+" onchange="onAnswer()"><span class="chip-text">15+</span></label>
                    </div><textarea class="wizard-notes" id="notes_q1_4" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q5</div><div class="question-text">What is your geographic operating model?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q1_5" value="Single region" onchange="onAnswer()"><span class="chip-text">Single region</span></label>
                        <label class="option-chip"><input type="radio" name="q1_5" value="Multi-region (same country)" onchange="onAnswer()"><span class="chip-text">Multi-region (same country)</span></label>
                        <label class="option-chip"><input type="radio" name="q1_5" value="Multi-country (same continent)" onchange="onAnswer()"><span class="chip-text">Multi-country (same continent)</span></label>
                        <label class="option-chip"><input type="radio" name="q1_5" value="Global (multiple continents)" onchange="onAnswer()"><span class="chip-text">Global (multiple continents)</span></label>
                    </div><textarea class="wizard-notes" id="notes_q1_5" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-nav"><div></div><button class="wiz-nav-btn primary" onclick="goToStage(1)">Next: Current Foundation â†’</button></div>
                </div>
                <div class="wizard-panel" id="panel1" style="display:none;">
                    <div class="panel-header"><span class="panel-icon">ðŸ—ï¸</span><div><h3>Stage 2: Current Foundation</h3><p>Existing platform, licensing, and readiness</p></div></div>
                    <div class="wizard-question"><div class="question-number">Q6</div><div class="question-text">What is your current Power BI licensing model?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q2_1" value="Power BI Free only" onchange="onAnswer()"><span class="chip-text">Power BI Free only</span></label>
                        <label class="option-chip"><input type="radio" name="q2_1" value="Power BI Pro" onchange="onAnswer()"><span class="chip-text">Power BI Pro</span></label>
                        <label class="option-chip"><input type="radio" name="q2_1" value="Premium Per User (PPU)" onchange="onAnswer()"><span class="chip-text">Premium Per User (PPU)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_1" value="Premium P-SKU (P1/P2/P3/P4)" onchange="onAnswer()"><span class="chip-text">Premium P-SKU (P1/P2/P3/P4)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_1" value="Microsoft Fabric (already using)" onchange="onAnswer()"><span class="chip-text">Microsoft Fabric (already using)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_1" value="No Power BI currently" onchange="onAnswer()"><span class="chip-text">No Power BI currently</span></label>
                    </div><textarea class="wizard-notes" id="notes_q2_1" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q7</div><div class="question-text">What are your top pain points? <span class="multi-hint">(select all that apply)</span></div><div class="option-grid">
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="Performance / slow reports" onchange="onAnswer()"><span class="chip-text">Performance / slow reports</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="Cost too expensive" onchange="onAnswer()"><span class="chip-text">Cost too expensive</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="Governance gaps" onchange="onAnswer()"><span class="chip-text">Governance gaps</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="Refresh failures" onchange="onAnswer()"><span class="chip-text">Refresh failures</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="Security gaps" onchange="onAnswer()"><span class="chip-text">Security gaps</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="No single source of truth" onchange="onAnswer()"><span class="chip-text">No single source of truth</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="Scalability ceiling" onchange="onAnswer()"><span class="chip-text">Scalability ceiling</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_2" value="Manual processes" onchange="onAnswer()"><span class="chip-text">Manual processes</span></label>
                    </div><textarea class="wizard-notes" id="notes_q2_2" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q8</div><div class="question-text">What is your current Azure commercial agreement?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q2_3" value="Enterprise Agreement (EA)" onchange="onAnswer()"><span class="chip-text">Enterprise Agreement (EA)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_3" value="Microsoft Customer Agreement (MCA)" onchange="onAnswer()"><span class="chip-text">Microsoft Customer Agreement (MCA)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_3" value="Cloud Solution Provider (CSP)" onchange="onAnswer()"><span class="chip-text">Cloud Solution Provider (CSP)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_3" value="Pay-As-You-Go" onchange="onAnswer()"><span class="chip-text">Pay-As-You-Go</span></label>
                        <label class="option-chip"><input type="radio" name="q2_3" value="Not sure / No Azure yet" onchange="onAnswer()"><span class="chip-text">Not sure / No Azure yet</span></label>
                    </div><textarea class="wizard-notes" id="notes_q2_3" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q9</div><div class="question-text">What other data platforms are currently in use? <span class="multi-hint">(select all that apply)</span></div><div class="option-grid">
                        <label class="option-chip"><input type="checkbox" name="q2_4" value="Azure Synapse Analytics" onchange="onAnswer()"><span class="chip-text">Azure Synapse Analytics</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_4" value="Azure Data Factory" onchange="onAnswer()"><span class="chip-text">Azure Data Factory</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_4" value="Databricks" onchange="onAnswer()"><span class="chip-text">Databricks</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_4" value="SQL Server / Azure SQL" onchange="onAnswer()"><span class="chip-text">SQL Server / Azure SQL</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_4" value="Snowflake" onchange="onAnswer()"><span class="chip-text">Snowflake</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_4" value="AWS / GCP services" onchange="onAnswer()"><span class="chip-text">AWS / GCP services</span></label>
                        <label class="option-chip"><input type="checkbox" name="q2_4" value="None / Spreadsheets only" onchange="onAnswer()"><span class="chip-text">None / Spreadsheets only</span></label>
                    </div><textarea class="wizard-notes" id="notes_q2_4" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q10</div><div class="question-text">What is your target migration timeline to Fabric?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q2_5" value="Immediate (< 1 month)" onchange="onAnswer()"><span class="chip-text">Immediate (< 1 month)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_5" value="Short-term (1â€“3 months)" onchange="onAnswer()"><span class="chip-text">Short-term (1â€“3 months)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_5" value="Medium-term (3â€“6 months)" onchange="onAnswer()"><span class="chip-text">Medium-term (3â€“6 months)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_5" value="Long-term (6â€“12 months)" onchange="onAnswer()"><span class="chip-text">Long-term (6â€“12 months)</span></label>
                        <label class="option-chip"><input type="radio" name="q2_5" value="Exploration / no timeline yet" onchange="onAnswer()"><span class="chip-text">Exploration / no timeline yet</span></label>
                    </div><textarea class="wizard-notes" id="notes_q2_5" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-nav"><button class="wiz-nav-btn" onclick="goToStage(0)">â† Previous</button><button class="wiz-nav-btn primary" onclick="goToStage(2)">Next: Data Estate â†’</button></div>
                </div>
                <div class="wizard-panel" id="panel2" style="display:none;">
                    <div class="panel-header"><span class="panel-icon">ðŸ—„ï¸</span><div><h3>Stage 3: Data Estate</h3><p>Data volumes, sources, and refresh patterns</p></div></div>
                    <div class="wizard-question"><div class="question-number">Q11</div><div class="question-text">What is your total data volume across all sources?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q3_1" value="< 10 GB" onchange="onAnswer()"><span class="chip-text">< 10 GB</span></label>
                        <label class="option-chip"><input type="radio" name="q3_1" value="10â€“100 GB" onchange="onAnswer()"><span class="chip-text">10â€“100 GB</span></label>
                        <label class="option-chip"><input type="radio" name="q3_1" value="100 GBâ€“1 TB" onchange="onAnswer()"><span class="chip-text">100 GBâ€“1 TB</span></label>
                        <label class="option-chip"><input type="radio" name="q3_1" value="1â€“10 TB" onchange="onAnswer()"><span class="chip-text">1â€“10 TB</span></label>
                        <label class="option-chip"><input type="radio" name="q3_1" value="10â€“50 TB" onchange="onAnswer()"><span class="chip-text">10â€“50 TB</span></label>
                        <label class="option-chip"><input type="radio" name="q3_1" value="50+ TB" onchange="onAnswer()"><span class="chip-text">50+ TB</span></label>
                    </div><textarea class="wizard-notes" id="notes_q3_1" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q12</div><div class="question-text">How frequently does your data need to be refreshed?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q3_2" value="Weekly" onchange="onAnswer()"><span class="chip-text">Weekly</span></label>
                        <label class="option-chip"><input type="radio" name="q3_2" value="Daily (once)" onchange="onAnswer()"><span class="chip-text">Daily (once)</span></label>
                        <label class="option-chip"><input type="radio" name="q3_2" value="Multiple times per day" onchange="onAnswer()"><span class="chip-text">Multiple times per day</span></label>
                        <label class="option-chip"><input type="radio" name="q3_2" value="Near real-time (15â€“60 mins)" onchange="onAnswer()"><span class="chip-text">Near real-time (15â€“60 mins)</span></label>
                        <label class="option-chip"><input type="radio" name="q3_2" value="Real-time (streaming)" onchange="onAnswer()"><span class="chip-text">Real-time (streaming)</span></label>
                    </div><textarea class="wizard-notes" id="notes_q3_2" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q13</div><div class="question-text">How many distinct data sources do you connect to?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q3_3" value="1â€“3" onchange="onAnswer()"><span class="chip-text">1â€“3</span></label>
                        <label class="option-chip"><input type="radio" name="q3_3" value="4â€“10" onchange="onAnswer()"><span class="chip-text">4â€“10</span></label>
                        <label class="option-chip"><input type="radio" name="q3_3" value="11â€“25" onchange="onAnswer()"><span class="chip-text">11â€“25</span></label>
                        <label class="option-chip"><input type="radio" name="q3_3" value="26â€“50" onchange="onAnswer()"><span class="chip-text">26â€“50</span></label>
                        <label class="option-chip"><input type="radio" name="q3_3" value="50+" onchange="onAnswer()"><span class="chip-text">50+</span></label>
                    </div><textarea class="wizard-notes" id="notes_q3_3" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q14</div><div class="question-text">What types of data do you primarily work with? <span class="multi-hint">(select all that apply)</span></div><div class="option-grid">
                        <label class="option-chip"><input type="checkbox" name="q3_4" value="Structured (SQL tables, CSV)" onchange="onAnswer()"><span class="chip-text">Structured (SQL tables, CSV)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q3_4" value="Semi-structured (JSON, Parquet, XML)" onchange="onAnswer()"><span class="chip-text">Semi-structured (JSON, Parquet, XML)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q3_4" value="Unstructured (images, documents, logs)" onchange="onAnswer()"><span class="chip-text">Unstructured (images, documents, logs)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q3_4" value="Streaming / event data" onchange="onAnswer()"><span class="chip-text">Streaming / event data</span></label>
                    </div><textarea class="wizard-notes" id="notes_q3_4" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q15</div><div class="question-text">What is your expected annual data growth rate?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q3_5" value="< 10% (stable)" onchange="onAnswer()"><span class="chip-text">< 10% (stable)</span></label>
                        <label class="option-chip"><input type="radio" name="q3_5" value="10â€“25% (moderate)" onchange="onAnswer()"><span class="chip-text">10â€“25% (moderate)</span></label>
                        <label class="option-chip"><input type="radio" name="q3_5" value="25â€“50% (fast)" onchange="onAnswer()"><span class="chip-text">25â€“50% (fast)</span></label>
                        <label class="option-chip"><input type="radio" name="q3_5" value="50â€“100% (rapid)" onchange="onAnswer()"><span class="chip-text">50â€“100% (rapid)</span></label>
                        <label class="option-chip"><input type="radio" name="q3_5" value="100%+ (explosive)" onchange="onAnswer()"><span class="chip-text">100%+ (explosive)</span></label>
                    </div><textarea class="wizard-notes" id="notes_q3_5" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-nav"><button class="wiz-nav-btn" onclick="goToStage(1)">â† Previous</button><button class="wiz-nav-btn primary" onclick="goToStage(3)">Next: Fabric Workloads â†’</button></div>
                </div>
                <div class="wizard-panel" id="panel3" style="display:none;">
                    <div class="panel-header"><span class="panel-icon">âš¡</span><div><h3>Stage 4: Fabric Workloads</h3><p>Which Fabric workloads, their intensity, and operational maturity</p></div></div>
                    <div class="wizard-question"><div class="question-number">Q16</div><div class="question-text">Which Fabric workloads do you plan to use? <span class="multi-hint">(select all that apply)</span></div><div class="option-grid">
                        <label class="option-chip"><input type="checkbox" name="q4_1" value="Data Engineering (Spark, Lakehouse)" onchange="onAnswer()"><span class="chip-text">Data Engineering (Spark, Lakehouse)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q4_1" value="Data Factory (Pipelines, Dataflows)" onchange="onAnswer()"><span class="chip-text">Data Factory (Pipelines, Dataflows)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q4_1" value="Data Warehouse (SQL analytics)" onchange="onAnswer()"><span class="chip-text">Data Warehouse (SQL analytics)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q4_1" value="Power BI (Semantic Models, Reports)" onchange="onAnswer()"><span class="chip-text">Power BI (Semantic Models, Reports)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q4_1" value="Real-Time Intelligence" onchange="onAnswer()"><span class="chip-text">Real-Time Intelligence</span></label>
                        <label class="option-chip"><input type="checkbox" name="q4_1" value="Data Science (ML)" onchange="onAnswer()"><span class="chip-text">Data Science (ML)</span></label>
                        <label class="option-chip"><input type="checkbox" name="q4_1" value="Not sure yet" onchange="onAnswer()"><span class="chip-text">Not sure yet</span></label>
                    </div><textarea class="wizard-notes" id="notes_q4_1" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q17</div><div class="question-text">Do you plan to use Copilot for Fabric?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q4_2" value="No" onchange="onAnswer()"><span class="chip-text">No</span></label>
                        <label class="option-chip"><input type="radio" name="q4_2" value="Yes, if available" onchange="onAnswer()"><span class="chip-text">Yes, if available</span></label>
                        <label class="option-chip"><input type="radio" name="q4_2" value="Yes, as a priority" onchange="onAnswer()"><span class="chip-text">Yes, as a priority</span></label>
                        <label class="option-chip"><input type="radio" name="q4_2" value="Not sure yet" onchange="onAnswer()"><span class="chip-text">Not sure yet</span></label>
                    </div><textarea class="wizard-notes" id="notes_q4_2" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q18</div><div class="question-text">How many concurrent Spark sessions do you expect at peak?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q4_3" value="None (no Spark)" onchange="onAnswer()"><span class="chip-text">None (no Spark)</span></label>
                        <label class="option-chip"><input type="radio" name="q4_3" value="1â€“3" onchange="onAnswer()"><span class="chip-text">1â€“3</span></label>
                        <label class="option-chip"><input type="radio" name="q4_3" value="4â€“10" onchange="onAnswer()"><span class="chip-text">4â€“10</span></label>
                        <label class="option-chip"><input type="radio" name="q4_3" value="11â€“25" onchange="onAnswer()"><span class="chip-text">11â€“25</span></label>
                        <label class="option-chip"><input type="radio" name="q4_3" value="25+" onchange="onAnswer()"><span class="chip-text">25+</span></label>
                    </div><textarea class="wizard-notes" id="notes_q4_3" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q19</div><div class="question-text">How many semantic models and reports will be hosted?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q4_4" value="< 10" onchange="onAnswer()"><span class="chip-text">< 10</span></label>
                        <label class="option-chip"><input type="radio" name="q4_4" value="10â€“50" onchange="onAnswer()"><span class="chip-text">10â€“50</span></label>
                        <label class="option-chip"><input type="radio" name="q4_4" value="51â€“150" onchange="onAnswer()"><span class="chip-text">51â€“150</span></label>
                        <label class="option-chip"><input type="radio" name="q4_4" value="151â€“500" onchange="onAnswer()"><span class="chip-text">151â€“500</span></label>
                        <label class="option-chip"><input type="radio" name="q4_4" value="500+" onchange="onAnswer()"><span class="chip-text">500+</span></label>
                    </div><textarea class="wizard-notes" id="notes_q4_4" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q20</div><div class="question-text">Do you use or plan to use CI/CD for data assets (deployment pipelines, Git integration)?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q4_5" value="No, not planned" onchange="onAnswer()"><span class="chip-text">No, not planned</span></label>
                        <label class="option-chip"><input type="radio" name="q4_5" value="Planning to adopt" onchange="onAnswer()"><span class="chip-text">Planning to adopt</span></label>
                        <label class="option-chip"><input type="radio" name="q4_5" value="Partially in place" onchange="onAnswer()"><span class="chip-text">Partially in place</span></label>
                        <label class="option-chip"><input type="radio" name="q4_5" value="Fully implemented" onchange="onAnswer()"><span class="chip-text">Fully implemented</span></label>
                    </div><textarea class="wizard-notes" id="notes_q4_5" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-nav"><button class="wiz-nav-btn" onclick="goToStage(2)">â† Previous</button><button class="wiz-nav-btn primary" onclick="goToStage(4)">Next: Users & Budget â†’</button></div>
                </div>
                <div class="wizard-panel" id="panel4" style="display:none;">
                    <div class="panel-header"><span class="panel-icon">ðŸ’°</span><div><h3>Stage 5: Users & Budget</h3><p>Consumption patterns, commercial constraints, and optimisation appetite</p></div></div>
                    <div class="wizard-question"><div class="question-number">Q21</div><div class="question-text">What is your peak concurrent user count?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q5_1" value="< 10" onchange="onAnswer()"><span class="chip-text">< 10</span></label>
                        <label class="option-chip"><input type="radio" name="q5_1" value="10â€“25" onchange="onAnswer()"><span class="chip-text">10â€“25</span></label>
                        <label class="option-chip"><input type="radio" name="q5_1" value="26â€“50" onchange="onAnswer()"><span class="chip-text">26â€“50</span></label>
                        <label class="option-chip"><input type="radio" name="q5_1" value="51â€“100" onchange="onAnswer()"><span class="chip-text">51â€“100</span></label>
                        <label class="option-chip"><input type="radio" name="q5_1" value="101â€“250" onchange="onAnswer()"><span class="chip-text">101â€“250</span></label>
                        <label class="option-chip"><input type="radio" name="q5_1" value="250+" onchange="onAnswer()"><span class="chip-text">250+</span></label>
                    </div><textarea class="wizard-notes" id="notes_q5_1" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q22</div><div class="question-text">What is your available monthly budget for Fabric capacity?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q5_2" value="< Â£500/mo" onchange="onAnswer()"><span class="chip-text">< Â£500/mo</span></label>
                        <label class="option-chip"><input type="radio" name="q5_2" value="Â£500â€“Â£1,500/mo" onchange="onAnswer()"><span class="chip-text">Â£500â€“Â£1,500/mo</span></label>
                        <label class="option-chip"><input type="radio" name="q5_2" value="Â£1,500â€“Â£3,000/mo" onchange="onAnswer()"><span class="chip-text">Â£1,500â€“Â£3,000/mo</span></label>
                        <label class="option-chip"><input type="radio" name="q5_2" value="Â£3,000â€“Â£6,000/mo" onchange="onAnswer()"><span class="chip-text">Â£3,000â€“Â£6,000/mo</span></label>
                        <label class="option-chip"><input type="radio" name="q5_2" value="Â£6,000â€“Â£15,000/mo" onchange="onAnswer()"><span class="chip-text">Â£6,000â€“Â£15,000/mo</span></label>
                        <label class="option-chip"><input type="radio" name="q5_2" value="Â£15,000+/mo" onchange="onAnswer()"><span class="chip-text">Â£15,000+/mo</span></label>
                        <label class="option-chip"><input type="radio" name="q5_2" value="Not yet defined" onchange="onAnswer()"><span class="chip-text">Not yet defined</span></label>
                    </div><textarea class="wizard-notes" id="notes_q5_2" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q23</div><div class="question-text">How many total named users (viewers + creators) will access Fabric?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q5_3" value="< 25" onchange="onAnswer()"><span class="chip-text">< 25</span></label>
                        <label class="option-chip"><input type="radio" name="q5_3" value="25â€“100" onchange="onAnswer()"><span class="chip-text">25â€“100</span></label>
                        <label class="option-chip"><input type="radio" name="q5_3" value="101â€“500" onchange="onAnswer()"><span class="chip-text">101â€“500</span></label>
                        <label class="option-chip"><input type="radio" name="q5_3" value="501â€“2,000" onchange="onAnswer()"><span class="chip-text">501â€“2,000</span></label>
                        <label class="option-chip"><input type="radio" name="q5_3" value="2,000+" onchange="onAnswer()"><span class="chip-text">2,000+</span></label>
                    </div><textarea class="wizard-notes" id="notes_q5_3" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q24</div><div class="question-text">Is your budget fixed or can it scale with usage?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q5_4" value="Strictly fixed" onchange="onAnswer()"><span class="chip-text">Strictly fixed</span></label>
                        <label class="option-chip"><input type="radio" name="q5_4" value="Fixed with some flexibility" onchange="onAnswer()"><span class="chip-text">Fixed with some flexibility</span></label>
                        <label class="option-chip"><input type="radio" name="q5_4" value="Elastic (scales with business value)" onchange="onAnswer()"><span class="chip-text">Elastic (scales with business value)</span></label>
                        <label class="option-chip"><input type="radio" name="q5_4" value="Not yet determined" onchange="onAnswer()"><span class="chip-text">Not yet determined</span></label>
                    </div><textarea class="wizard-notes" id="notes_q5_4" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-question"><div class="question-number">Q25</div><div class="question-text">Are you open to using Pause/Resume to optimise costs?</div><div class="option-grid">
                        <label class="option-chip"><input type="radio" name="q5_5" value="Yes, for dev/test environments" onchange="onAnswer()"><span class="chip-text">Yes, for dev/test environments</span></label>
                        <label class="option-chip"><input type="radio" name="q5_5" value="Yes, for all non-production" onchange="onAnswer()"><span class="chip-text">Yes, for all non-production</span></label>
                        <label class="option-chip"><input type="radio" name="q5_5" value="No, need 24/7 availability" onchange="onAnswer()"><span class="chip-text">No, need 24/7 availability</span></label>
                        <label class="option-chip"><input type="radio" name="q5_5" value="Not sure yet" onchange="onAnswer()"><span class="chip-text">Not sure yet</span></label>
                    </div><textarea class="wizard-notes" id="notes_q5_5" placeholder="Additional notes (optional)â€¦" oninput="onAnswer()"></textarea></div>
                    <div class="wizard-nav"><button class="wiz-nav-btn" onclick="goToStage(3)">â† Previous</button><button class="wiz-nav-btn generate" onclick="generateAssessment()">ðŸŽ¯ Generate Assessment</button></div>
                </div>
            </div>
            <div class="wizard-results" id="wizardResults" style="display:none;">
                <div class="results-header">
                    <h3>ðŸŽ¯ Your F-SKU Assessment Results</h3>
                    <div class="results-actions">
                        <button class="wiz-nav-btn" onclick="window.print()">ðŸ“„ Export to PDF</button>
                        <button class="wiz-nav-btn" onclick="exportCSV()">ðŸ“Š Export to CSV</button>
                        <button class="wiz-nav-btn" onclick="resetWizard()">â†º Start Over</button>
                    </div>
                </div>
                <div id="resultsContent"></div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div><strong>SEED Thought Leadership</strong> | Fabric Compute Cost Optimisation Reference Guide | Version 1.0</div>
            <div>Last Updated: January 2026</div>
        </div>
    </div>
    <script>
    (function() {
        // Build search index from all table rows in both sections
        var index = [];
        var rows = document.querySelectorAll('table tbody tr');
        rows.forEach(function(row) {
            var cells = row.querySelectorAll('td');
            if (cells.length >= 2) {
                var num = cells[0].textContent.trim();
                var text = cells[1].textContent.trim();
                // Get category from closest category-header
                var section = row.closest('.category-section');
                var cat = section ? section.querySelector('.category-header') : null;
                var catName = cat ? cat.textContent.trim() : '';
                // Get benefit if present
                var benefitEl = row.querySelector('.benefit-high, .benefit-mid, .benefit-low');
                var benefit = benefitEl ? benefitEl.textContent.trim() : '';
                // Get value types if present
                var vtypes = [];
                row.querySelectorAll('.vtype-tag').forEach(function(t) { vtypes.push(t.textContent.trim()); });
                var effort = '';
                var effortEl = row.querySelector('.effort-tag');
                if (effortEl) effort = effortEl.textContent.trim();

                index.push({
                    num: num,
                    text: text,
                    category: catName,
                    benefit: benefit,
                    vtypes: vtypes,
                    effort: effort,
                    row: row,
                    searchable: (num + ' ' + text + ' ' + catName + ' ' + benefit + ' ' + vtypes.join(' ') + ' ' + effort).toLowerCase()
                });
            }
        });

        // Deduplicate by num (same recommendation appears in both views)
        var seen = {};
        var uniqueIndex = [];
        index.forEach(function(item) {
            var key = item.num + '|' + item.text.substring(0, 50);
            if (!seen[key]) {
                seen[key] = true;
                // Find ALL matching rows (both views)
                item.allRows = index.filter(function(i) {
                    return i.num === item.num && i.text.substring(0, 50) === item.text.substring(0, 50);
                }).map(function(i) { return i.row; });
                uniqueIndex.push(item);
            }
        });

        var input = document.getElementById('searchInput');
        var resultsDiv = document.getElementById('searchResults');
        var activeIndex = -1;

        function highlightText(text, query) {
            if (!query) return text;
            var words = query.trim().split(/\s+/).filter(function(w) { return w.length > 0; });
            var result = text;
            words.forEach(function(word) {
                var escaped = word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                var regex = new RegExp('(' + escaped + ')', 'gi');
                result = result.replace(regex, '<mark>$1</mark>');
            });
            return result;
        }

        function search(query) {
            activeIndex = -1;
            if (!query || query.length < 2) {
                resultsDiv.classList.remove('active');
                resultsDiv.innerHTML = '';
                return;
            }

            var q = query.toLowerCase();
            var words = q.trim().split(/\s+/).filter(function(w) { return w.length > 0; });
            
            var matches = uniqueIndex.filter(function(item) {
                return words.every(function(word) {
                    return item.searchable.indexOf(word) !== -1;
                });
            });

            if (matches.length === 0) {
                resultsDiv.innerHTML = '<div class="search-no-results">No recommendations found for "<strong>' + query + '</strong>"</div>';
                resultsDiv.classList.add('active');
                return;
            }

            // Limit to 10 results
            var shown = matches.slice(0, 10);
            var html = '';
            shown.forEach(function(item, i) {
                var meta = item.category;
                if (item.benefit) meta += ' Â· ' + item.benefit;
                if (item.vtypes.length) meta += ' Â· ' + item.vtypes.join(', ');
                if (item.effort) meta += ' Â· ' + item.effort;

                html += '<div class="search-result-item" data-index="' + i + '">';
                html += '<span class="search-result-num">' + item.num + '</span>';
                html += '<div><div class="search-result-text">' + highlightText(item.text, query) + '</div>';
                html += '<div class="search-result-meta">' + highlightText(meta, query) + '</div></div>';
                html += '</div>';
            });

            if (matches.length > 10) {
                html += '<div class="search-no-results" style="font-size:12px;">' + (matches.length - 10) + ' more results â€” refine your search</div>';
            }

            resultsDiv.innerHTML = html;
            resultsDiv.classList.add('active');

            // Click handlers
            resultsDiv.querySelectorAll('.search-result-item').forEach(function(el, i) {
                el.addEventListener('click', function() {
                    selectResult(shown[i]);
                });
            });
        }

        function selectResult(item) {
            resultsDiv.classList.remove('active');
            // Highlight and scroll to the first visible row
            var targetRow = item.allRows[0];
            
            // Remove any previous highlights
            document.querySelectorAll('.search-highlight').forEach(function(el) {
                el.classList.remove('search-highlight');
            });

            // Highlight all matching rows in both views
            item.allRows.forEach(function(row) {
                row.classList.add('search-highlight');
            });

            // Scroll to the row
            targetRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function setActiveResult(index) {
            var items = resultsDiv.querySelectorAll('.search-result-item');
            items.forEach(function(el) { el.classList.remove('active'); });
            if (index >= 0 && index < items.length) {
                items[index].classList.add('active');
                items[index].scrollIntoView({ block: 'nearest' });
            }
        }

        // Event listeners
        input.addEventListener('input', function() {
            search(this.value);
        });

        input.addEventListener('keydown', function(e) {
            var items = resultsDiv.querySelectorAll('.search-result-item');
            var shown = [];
            // Rebuild shown list from unique index
            var q = input.value.toLowerCase();
            var words = q.trim().split(/\s+/).filter(function(w) { return w.length > 0; });
            if (words.length > 0) {
                shown = uniqueIndex.filter(function(item) {
                    return words.every(function(word) { return item.searchable.indexOf(word) !== -1; });
                }).slice(0, 10);
            }

            if (e.key === 'ArrowDown') {
                e.preventDefault();
                activeIndex = Math.min(activeIndex + 1, items.length - 1);
                setActiveResult(activeIndex);
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                activeIndex = Math.max(activeIndex - 1, 0);
                setActiveResult(activeIndex);
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (activeIndex >= 0 && activeIndex < shown.length) {
                    selectResult(shown[activeIndex]);
                } else if (shown.length > 0) {
                    selectResult(shown[0]);
                }
            } else if (e.key === 'Escape') {
                resultsDiv.classList.remove('active');
                input.value = '';
                input.blur();
                document.querySelectorAll('.search-highlight').forEach(function(el) {
                    el.classList.remove('search-highlight');
                });
            }
        });

        // Close results when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-container')) {
                resultsDiv.classList.remove('active');
            }
        });

        // Re-show results when focusing back on input with content
        input.addEventListener('focus', function() {
            if (this.value.length >= 2) {
                search(this.value);
            }
        });
    })();
    </script>
    <script>
    (function() {
        var STAGES = [
            {"id":"org-profile","title":"Organisation Profile","icon":"ðŸ¢","desc":"Scale, maturity, and operating context","questions":[
                {"id":"q1_1","text":"How many employees does your organisation have?","type":"single","options":["< 500","500â€“2,000","2,000â€“10,000","10,000â€“50,000","50,000+"]},
                {"id":"q1_2","text":"How would you describe your organisation's data maturity?","type":"single","options":["Ad-hoc (spreadsheets, no central platform)","Reactive (some BI tools, limited governance)","Managed (centralised platform, some governance)","Optimised (well-governed, automated, CI/CD)","Advanced (data mesh, self-service with guardrails)"]},
                {"id":"q1_3","text":"What industry sector does your organisation operate in?","type":"single","options":["Financial Services","Healthcare & Life Sciences","Government & Public Sector","Retail & Consumer Goods","Manufacturing & Energy","Technology & Media","Education & Non-Profit","Other"]},
                {"id":"q1_4","text":"How many business units or departments will use Fabric?","type":"single","options":["1 (single team)","2â€“5","6â€“15","15+"]},
                {"id":"q1_5","text":"What is your geographic operating model?","type":"single","options":["Single region","Multi-region (same country)","Multi-country (same continent)","Global (multiple continents)"]}
            ]},
            {"id":"current-foundation","title":"Current Foundation","icon":"ðŸ—ï¸","desc":"Existing platform, licensing, and readiness","questions":[
                {"id":"q2_1","text":"What is your current Power BI licensing model?","type":"single","options":["Power BI Free only","Power BI Pro","Premium Per User (PPU)","Premium P-SKU (P1/P2/P3/P4)","Microsoft Fabric (already using)","No Power BI currently"]},
                {"id":"q2_2","text":"What are your top pain points? (select all that apply)","type":"multi","options":["Performance / slow reports","Cost too expensive","Governance gaps","Refresh failures","Security gaps","No single source of truth","Scalability ceiling","Manual processes"]},
                {"id":"q2_3","text":"What is your current Azure commercial agreement?","type":"single","options":["Enterprise Agreement (EA)","Microsoft Customer Agreement (MCA)","Cloud Solution Provider (CSP)","Pay-As-You-Go","Not sure / No Azure yet"]},
                {"id":"q2_4","text":"What other data platforms are currently in use?","type":"multi","options":["Azure Synapse Analytics","Azure Data Factory","Databricks","SQL Server / Azure SQL","Snowflake","AWS / GCP services","None / Spreadsheets only"]},
                {"id":"q2_5","text":"What is your target migration timeline to Fabric?","type":"single","options":["Immediate (< 1 month)","Short-term (1â€“3 months)","Medium-term (3â€“6 months)","Long-term (6â€“12 months)","Exploration / no timeline yet"]}
            ]},
            {"id":"data-estate","title":"Data Estate","icon":"ðŸ—„ï¸","desc":"Data volumes, sources, and refresh patterns","questions":[
                {"id":"q3_1","text":"What is your total data volume across all sources?","type":"single","options":["< 10 GB","10â€“100 GB","100 GBâ€“1 TB","1â€“10 TB","10â€“50 TB","50+ TB"]},
                {"id":"q3_2","text":"How frequently does your data need to be refreshed?","type":"single","options":["Weekly","Daily (once)","Multiple times per day","Near real-time (15â€“60 mins)","Real-time (streaming)"]},
                {"id":"q3_3","text":"How many distinct data sources do you connect to?","type":"single","options":["1â€“3","4â€“10","11â€“25","26â€“50","50+"]},
                {"id":"q3_4","text":"What types of data do you primarily work with?","type":"multi","options":["Structured (SQL tables, CSV)","Semi-structured (JSON, Parquet, XML)","Unstructured (images, documents, logs)","Streaming / event data"]},
                {"id":"q3_5","text":"What is your expected annual data growth rate?","type":"single","options":["< 10% (stable)","10â€“25% (moderate)","25â€“50% (fast)","50â€“100% (rapid)","100%+ (explosive)"]}
            ]},
            {"id":"fabric-workloads","title":"Fabric Workloads","icon":"âš¡","desc":"Which Fabric workloads, their intensity, and operational maturity","questions":[
                {"id":"q4_1","text":"Which Fabric workloads do you plan to use?","type":"multi","options":["Data Engineering (Spark, Lakehouse)","Data Factory (Pipelines, Dataflows)","Data Warehouse (SQL analytics)","Power BI (Semantic Models, Reports)","Real-Time Intelligence","Data Science (ML)","Not sure yet"]},
                {"id":"q4_2","text":"Do you plan to use Copilot for Fabric?","type":"single","options":["No","Yes, if available","Yes, as a priority","Not sure yet"]},
                {"id":"q4_3","text":"How many concurrent Spark sessions do you expect at peak?","type":"single","options":["None (no Spark)","1â€“3","4â€“10","11â€“25","25+"]},
                {"id":"q4_4","text":"How many semantic models and reports will be hosted?","type":"single","options":["< 10","10â€“50","51â€“150","151â€“500","500+"]},
                {"id":"q4_5","text":"Do you use or plan to use CI/CD for data assets?","type":"single","options":["No, not planned","Planning to adopt","Partially in place","Fully implemented"]}
            ]},
            {"id":"users-budget","title":"Users & Budget","icon":"ðŸ’°","desc":"Consumption patterns, commercial constraints, and optimisation appetite","questions":[
                {"id":"q5_1","text":"What is your peak concurrent user count?","type":"single","options":["< 10","10â€“25","26â€“50","51â€“100","101â€“250","250+"]},
                {"id":"q5_2","text":"What is your available monthly budget for Fabric capacity?","type":"single","options":["< Â£500/mo","Â£500â€“Â£1,500/mo","Â£1,500â€“Â£3,000/mo","Â£3,000â€“Â£6,000/mo","Â£6,000â€“Â£15,000/mo","Â£15,000+/mo","Not yet defined"]},
                {"id":"q5_3","text":"How many total named users (viewers + creators) will access Fabric?","type":"single","options":["< 25","25â€“100","101â€“500","501â€“2,000","2,000+"]},
                {"id":"q5_4","text":"Is your budget fixed or can it scale with usage?","type":"single","options":["Strictly fixed","Fixed with some flexibility","Elastic (scales with business value)","Not yet determined"]},
                {"id":"q5_5","text":"Are you open to using Pause/Resume to optimise costs?","type":"single","options":["Yes, for dev/test environments","Yes, for all non-production","No, need 24/7 availability","Not sure yet"]}
            ]}
        ];
        var TOTAL_Q = 25;
        var currentStage = 0;
        var SKU_TABLE = [
            {name:'F2',cus:2,payg:262,res:158},{name:'F4',cus:4,payg:525,res:315},
            {name:'F8',cus:8,payg:1049,res:630},{name:'F16',cus:16,payg:2099,res:1260},
            {name:'F32',cus:32,payg:4198,res:2519},{name:'F64',cus:64,payg:8396,res:5038},
            {name:'F128',cus:128,payg:16791,res:10076},{name:'F256',cus:256,payg:33583,res:20151},
            {name:'F512',cus:512,payg:67165,res:40302},{name:'F1024',cus:1024,payg:134330,res:80604},
            {name:'F2048',cus:2048,payg:268661,res:161208}
        ];
        function sku(n){return SKU_TABLE.find(function(s){return s.name===n});}
        window.goToStage = function(i) {
            if(i<0||i>=STAGES.length)return;
            for(var x=0;x<STAGES.length;x++){document.getElementById('panel'+x).style.display='none';document.getElementById('stageBtn'+x).classList.remove('active');}
            document.getElementById('panel'+i).style.display='block';
            document.getElementById('stageBtn'+i).classList.add('active');
            currentStage=i; updateProgress();
            document.getElementById('fsku').scrollIntoView({behavior:'smooth',block:'start'});
        };
        window.onAnswer = function(){updateProgress();};
        function getAnswer(qid,type){
            if(type==='multi'){var v=[];document.querySelectorAll('input[name="'+qid+'"]:checked').forEach(function(c){v.push(c.value);});return v;}
            var s=document.querySelector('input[name="'+qid+'"]:checked');return s?s.value:'';
        }
        function getNote(qid){var e=document.getElementById('notes_'+qid);return e?e.value.trim():'';}
        function updateProgress(){
            var ans=0;
            STAGES.forEach(function(st){st.questions.forEach(function(q){
                if(q.type==='multi'){if(document.querySelectorAll('input[name="'+q.id+'"]:checked').length>0)ans++;}
                else{if(document.querySelector('input[name="'+q.id+'"]:checked'))ans++;}
            });});
            var pct=Math.round((ans/TOTAL_Q)*100);
            document.getElementById('wizardProgressBar').style.width=pct+'%';
            document.getElementById('wizardProgressText').textContent='Stage '+(currentStage+1)+' of '+STAGES.length+' \u2014 '+ans+'/'+TOTAL_Q+' answered ('+pct+'%)';
            STAGES.forEach(function(st,si){
                var sa=0;st.questions.forEach(function(q){
                    if(q.type==='multi'){if(document.querySelectorAll('input[name="'+q.id+'"]:checked').length>0)sa++;}
                    else{if(document.querySelector('input[name="'+q.id+'"]:checked'))sa++;}
                });
                var b=document.getElementById('stageBtn'+si);
                if(sa===st.questions.length&&si!==currentStage)b.classList.add('completed');else b.classList.remove('completed');
            });
        }
        function optIdx(qid,max){
            var a=getAnswer(qid,'single');if(!a)return 0;var q=null;
            STAGES.forEach(function(s){s.questions.forEach(function(x){if(x.id===qid)q=x;});});
            if(!q)return 0;var i=q.options.indexOf(a);if(i<0)return 0;
            return(i/Math.max(q.options.length-1,1))*max;
        }
        function multiScore(qid,max){
            var a=getAnswer(qid,'multi');if(!a||!a.length)return 0;var q=null;
            STAGES.forEach(function(s){s.questions.forEach(function(x){if(x.id===qid)q=x;});});
            if(!q)return 0;return Math.min(a.length/Math.max(q.options.length-1,1),1)*max;
        }
        function computeScores(){
            // Stage 1: Organisation (employees 25, maturity 25, industry 15, departments 20, geography 15)
            var orgRaw=(optIdx('q1_1',25)+optIdx('q1_2',25)+optIdx('q1_3',15)+optIdx('q1_4',20)+optIdx('q1_5',15));
            // Stage 3: Data Estate (volume 25, frequency 25, sources 20, types 15, growth 15)
            var dataRaw=(optIdx('q3_1',25)+optIdx('q3_2',25)+optIdx('q3_3',20)+multiScore('q3_4',15)+optIdx('q3_5',15));
            // Stage 4: Workloads (workload mix 30, copilot 15, spark 20, models 20, cicd 15)
            var wklRaw=(multiScore('q4_1',30)+optIdx('q4_2',15)+optIdx('q4_3',20)+optIdx('q4_4',20)+optIdx('q4_5',15));
            // Stage 5: Users (concurrent 30, budget 25, total users 20, budget flex 15, pause 10)
            var usrRaw=(optIdx('q5_1',30)+optIdx('q5_3',20));
            var budRaw=(optIdx('q5_2',25)+optIdx('q5_4',15));
            return {
                orgScale:     Math.min(10, orgRaw/100*10),
                dataEstate:   Math.min(10, dataRaw/100*10),
                workloads:    Math.min(10, wklRaw/100*10),
                users:        Math.min(10, usrRaw/50*10),
                budget:       Math.min(10, budRaw/40*10)
            };
        }
        function drawRadar(sc,id){
            var dims=[{k:'orgScale',l:'Organisation'},{k:'dataEstate',l:'Data Estate'},{k:'workloads',l:'Workloads'},{k:'users',l:'Users'},{k:'budget',l:'Budget'}];
            var n=dims.length,sz=340,cx=sz/2,cy=sz/2,R=110,step=2*Math.PI/n,start=-Math.PI/2;
            var svg='<svg width="'+sz+'" height="'+sz+'" viewBox="0 0 '+sz+' '+sz+'">';
            for(var lv=2;lv<=10;lv+=2){var gr=R*(lv/10);svg+='<circle cx="'+cx+'" cy="'+cy+'" r="'+gr+'" fill="none" stroke="#e8e8ed" stroke-width="1"/>';}
            for(var i=0;i<n;i++){var a=start+i*step;svg+='<line x1="'+cx+'" y1="'+cy+'" x2="'+(cx+R*Math.cos(a)).toFixed(1)+'" y2="'+(cy+R*Math.sin(a)).toFixed(1)+'" stroke="#e8e8ed" stroke-width="1"/>';}
            var pts=[];
            for(var i=0;i<n;i++){var a=start+i*step;var v=sc[dims[i].k]||0;var pr=R*(v/10);pts.push((cx+pr*Math.cos(a)).toFixed(1)+','+(cy+pr*Math.sin(a)).toFixed(1));}
            svg+='<polygon points="'+pts.join(' ')+'" fill="rgba(196,101,58,0.15)" stroke="var(--accent)" stroke-width="2.5"/>';
            for(var i=0;i<n;i++){
                var a=start+i*step;var v=sc[dims[i].k]||0;var pr=R*(v/10);
                var px=(cx+pr*Math.cos(a)).toFixed(1),py=(cy+pr*Math.sin(a)).toFixed(1);
                svg+='<circle cx="'+px+'" cy="'+py+'" r="5" fill="var(--accent)"/>';
                var lx=cx+(R+32)*Math.cos(a),ly=cy+(R+32)*Math.sin(a);
                var anc='middle';if(Math.cos(a)<-0.3)anc='end';else if(Math.cos(a)>0.3)anc='start';
                svg+='<text x="'+lx.toFixed(1)+'" y="'+(ly+4).toFixed(1)+'" text-anchor="'+anc+'" font-size="11" font-family="Inter,sans-serif" fill="#6e6e73" font-weight="500">'+dims[i].l+'</text>';
                svg+='<text x="'+lx.toFixed(1)+'" y="'+(ly+17).toFixed(1)+'" text-anchor="'+anc+'" font-size="12" font-family="Inter,sans-serif" fill="#1d1d1f" font-weight="700">'+v.toFixed(1)+'/10</text>';
            }
            svg+='</svg>';
            document.getElementById(id).innerHTML=svg;
        }
        window.generateAssessment = function(){
            var sc=computeScores();
            var composite=(sc.orgScale*0.15+sc.dataEstate*0.25+sc.workloads*0.25+sc.users*0.20+sc.budget*0.15);
            var copilot=getAnswer('q4_2','single')==='Yes, as a priority';
            var prodSku;
            if(composite<=1.5)prodSku='F2';else if(composite<=2.5)prodSku='F4';else if(composite<=3.5)prodSku='F8';
            else if(composite<=4.5)prodSku='F16';else if(composite<=5.5)prodSku='F32';else if(composite<=6.5)prodSku='F64';
            else if(composite<=7.5)prodSku='F128';else if(composite<=8.5)prodSku='F256';else prodSku='F512';
            if(copilot&&parseInt(prodSku.replace('F',''))<64)prodSku='F64';
            var prodCU=parseInt(prodSku.replace('F',''));
            var valid=[2,4,8,16,32,64,128,256,512,1024,2048];
            var devCU=valid.reduce(function(p,c){return Math.abs(c-Math.max(2,Math.floor(prodCU/4)))<Math.abs(p-Math.max(2,Math.floor(prodCU/4)))?c:p;});
            var devSku='F'+devCU;
            var p=sku(prodSku),d=sku(devSku);
            var html='';
            html+='<div class="result-section-title">ðŸ“¡ Workload Profile</div>';
            html+='<div class="radar-container" id="radarChart"></div>';
            html+='<div class="result-section-title">ðŸ’¡ Recommended Capacity Architecture</div>';
            html+='<div class="sku-card dev"><h4>ðŸŸ  Development</h4><div class="sku-name">'+devSku+'</div><p>'+d.cus+' CUs â€” Pause evenings & weekends to save ~60%</p></div>';
            html+='<div class="sku-card prod"><h4>ðŸŸ¢ Production</h4><div class="sku-name">'+prodSku+'</div><p>'+p.cus+' CUs â€” Monitor with Capacity Metrics App for 2â€“4 weeks then adjust</p></div>';
            if(copilot) html+='<div class="risk-flag">âš ï¸ <strong>Copilot requirement:</strong> F64 minimum applied to production capacity</div>';
            html+='<div class="result-section-title">ðŸ’° Cost Comparison</div>';
            var totalPayg=p.payg+d.payg;
            var totalRes=p.res+d.res;
            var withPause=p.payg+(d.payg*0.4);
            var optimised=p.res+(d.payg*0.4);
            html+='<table class="budget-table"><thead><tr><th>Scenario</th><th>Monthly (est.)</th><th>Annual (est.)</th><th>Notes</th></tr></thead><tbody>';
            html+='<tr><td><strong>All PAYG</strong></td><td>~\u00a3'+totalPayg.toLocaleString()+'</td><td>~\u00a3'+(totalPayg*12).toLocaleString()+'</td><td>Maximum flexibility</td></tr>';
            html+='<tr><td><strong>PAYG + Pause/Resume</strong></td><td>~\u00a3'+Math.round(withPause).toLocaleString()+'</td><td>~\u00a3'+Math.round(withPause*12).toLocaleString()+'</td><td>Dev paused evenings & weekends</td></tr>';
            html+='<tr><td><strong>Reserved (1-year)</strong></td><td>~\u00a3'+totalRes.toLocaleString()+'</td><td>~\u00a3'+(totalRes*12).toLocaleString()+'</td><td>~40% discount, committed</td></tr>';
            html+='<tr><td><strong>Optimised mix</strong></td><td>~\u00a3'+Math.round(optimised).toLocaleString()+'</td><td>~\u00a3'+Math.round(optimised*12).toLocaleString()+'</td><td>Reserved prod + PAYG dev with pause</td></tr>';
            html+='</tbody></table>';
            html+='<p style="font-size:11px;color:var(--text-tertiary);">* UK South PAYG estimates (Feb 2025). Verify at <a href="https://azure.microsoft.com/en-gb/pricing/details/microsoft-fabric/" target="_blank" style="color:var(--accent);">azure.microsoft.com/pricing</a>.</p>';
            // === Validation & Rationale Section ===
            html+='<div class="result-section-title">âœ… Validation & Rationale</div>';
            // Gather all user answers
            var a_emp=getAnswer('q1_1','single')||'Not answered';
            var a_mat=getAnswer('q1_2','single')||'Not answered';
            var a_ind=getAnswer('q1_3','single')||'Not answered';
            var a_dept=getAnswer('q1_4','single')||'Not answered';
            var a_geo=getAnswer('q1_5','single')||'Not answered';
            var a_lic=getAnswer('q2_1','single')||'Not answered';
            var a_pain=getAnswer('q2_2','multi');
            var a_azure=getAnswer('q2_3','single')||'Not answered';
            var a_plat=getAnswer('q2_4','multi');
            var a_timeline=getAnswer('q2_5','single')||'Not answered';
            var a_vol=getAnswer('q3_1','single')||'Not answered';
            var a_freq=getAnswer('q3_2','single')||'Not answered';
            var a_src=getAnswer('q3_3','single')||'Not answered';
            var a_dtype=getAnswer('q3_4','multi');
            var a_growth=getAnswer('q3_5','single')||'Not answered';
            var a_wkl=getAnswer('q4_1','multi');
            var a_cop=getAnswer('q4_2','single')||'Not answered';
            var a_spark=getAnswer('q4_3','single')||'Not answered';
            var a_models=getAnswer('q4_4','single')||'Not answered';
            var a_cicd=getAnswer('q4_5','single')||'Not answered';
            var a_usr=getAnswer('q5_1','single')||'Not answered';
            var a_bud=getAnswer('q5_2','single')||'Not answered';
            var a_total=getAnswer('q5_3','single')||'Not answered';
            var a_flex=getAnswer('q5_4','single')||'Not answered';
            var a_pause=getAnswer('q5_5','single')||'Not answered';
            // Fit indicators
            function fitTag(score){
                if(score>=6)return'<span class="fit-tag fit-strong">Strong Fit</span>';
                if(score>=3)return'<span class="fit-tag fit-moderate">Moderate Fit</span>';
                return'<span class="fit-tag fit-review">Needs Review</span>';
            }
            // Rationale builders â€” now incorporating all questions
            function orgRationale(){
                var r='With <strong>'+a_emp+'</strong> employees and a <strong>'+a_mat.split('(')[0].trim()+'</strong> data maturity level';
                r+=', operating in <strong>'+a_ind+'</strong>';
                var regulated=['Financial Services','Healthcare & Life Sciences','Government & Public Sector'];
                if(regulated.indexOf(a_ind)>=0) r+=' (a regulated sector requiring stricter governance and compliance overhead)';
                r+='. ';
                r+='<strong>'+a_dept+'</strong> business unit(s) will use Fabric across a <strong>'+a_geo.toLowerCase()+'</strong> footprint. ';
                if(sc.orgScale>=6)r+='This combination of scale, sector complexity, and multi-department usage drives the need for a higher-tier F-SKU with sufficient CU headroom.';
                else if(sc.orgScale>=3)r+='This profile suggests a mid-range F-SKU â€” enough capacity for your current teams with room to grow without over-provisioning.';
                else r+='Your smaller scale and concentrated usage mean a lower-tier F-SKU keeps costs aligned with demand while covering your needs.';
                return r;
            }
            function dataRationale(){
                var r='A data estate of <strong>'+a_vol+'</strong> across <strong>'+a_src+'</strong> data sources with <strong>'+a_freq.toLowerCase()+'</strong> refresh frequency. ';
                var dtypes=a_dtype&&a_dtype.length?a_dtype.join(', '):'Not specified';
                r+='Primary data types: <strong>'+dtypes+'</strong>. ';
                r+='Expected growth rate: <strong>'+a_growth.split('(')[0].trim()+'</strong>. ';
                if(sc.dataEstate>=6)r+='High volume, diverse sources, and frequent refreshes combined with rapid growth require sustained CU capacity to avoid throttling and ensure timely data availability.';
                else if(sc.dataEstate>=3)r+='The recommended SKU balances refresh performance with cost efficiency â€” your data footprint is moderate but monitor growth closely as it may warrant future scale-up.';
                else r+='Your data footprint is lightweight â€” a smaller SKU handles this volume, source count, and refresh cadence comfortably.';
                return r;
            }
            function workloadRationale(){
                var wkls=a_wkl&&a_wkl.length?a_wkl.join(', '):'None selected';
                var r='Planned workloads: <strong>'+wkls+'</strong>. ';
                if(a_spark!=='None (no Spark)')r+='With <strong>'+a_spark+'</strong> expected concurrent Spark sessions, each reserving CUs, this is a key capacity driver. ';
                r+='Hosting <strong>'+a_models+'</strong> semantic models/reports drives background refresh load. ';
                if(a_cicd==='Fully implemented'||a_cicd==='Partially in place')r+='Your CI/CD pipeline maturity (<strong>'+a_cicd.toLowerCase()+'</strong>) adds build and validation workloads. ';
                if(a_wkl&&a_wkl.length>=4)r+='Running multiple workload types simultaneously demands higher CU headroom. ';
                else if(a_wkl&&a_wkl.length>=2)r+='A moderate workload mix benefits from sufficient CUs for parallel execution. ';
                if(a_cop==='Yes, as a priority')r+='Your priority use of <strong>Copilot for Fabric</strong> enforces a minimum F64 capacity.';
                else if(a_cop==='Yes, if available')r+='If Copilot is activated, note F64 is the minimum required SKU.';
                return r;
            }
            function usersRationale(){
                var r='<strong>'+a_usr+'</strong> peak concurrent users from a total base of <strong>'+a_total+'</strong> named users. ';
                if(sc.users>=6)r+='This high concurrency and user base ensures the SKU provides responsive report rendering and query execution without triggering smoothing or throttling.';
                else if(sc.users>=3)r+='The SKU provides adequate headroom for your user base while keeping costs proportional to actual consumption.';
                else r+='A smaller SKU comfortably serves this user base â€” interactive query performance will remain strong.';
                return r;
            }
            function budgetRationale(){
                var r='Monthly budget of <strong>'+a_bud+'</strong> with <strong>'+a_flex.toLowerCase()+'</strong> budget flexibility. ';
                if(a_pause.indexOf('Yes')===0)r+='Your willingness to use Pause/Resume (<strong>'+a_pause.toLowerCase()+'</strong>) can reduce dev/test costs by ~60%. ';
                else if(a_pause==='No, need 24/7 availability')r+='24/7 availability means Pause/Resume savings are not applicable â€” reserved pricing becomes more important. ';
                if(sc.budget>=6)r+='This budget supports the recommended <strong>'+prodSku+'</strong>, with room for reserved pricing savings.';
                else if(sc.budget>=3)r+='Consider the optimised mix (reserved prod + PAYG dev with pause/resume) to maximise value within this budget.';
                else r+='Budget is tighter for the computed workload needs â€” review Reserved and Pause/Resume options carefully. The <strong>'+prodSku+'</strong> recommendation prioritises capability.';
                return r;
            }
            // Build summary
            var compositeLabel=composite>=6?'high':'moderate';
            if(composite<3)compositeLabel='lower';
            html+='<div class="validation-summary"><p>Based on your responses across all 25 questions and five dimensions, your composite score of <strong>'+composite.toFixed(1)+'/10</strong> indicates a <strong>'+compositeLabel+' demand profile</strong>. ';
            html+='We recommend <strong>'+prodSku+'</strong> for production and <strong>'+devSku+'</strong> for development. ';
            html+='Below is a breakdown of how each dimension influenced this recommendation.</p></div>';
            // Build cards
            html+='<div class="validation-grid">';
            // 1. Organisation
            html+='<div class="validation-card"><div class="validation-card-header"><div class="validation-card-title"><span class="vc-icon">ðŸ¢</span>Organisation Profile</div>'+fitTag(sc.orgScale)+'</div>';
            html+='<div class="validation-answer"><strong>Employees:</strong> '+a_emp+' Â· <strong>Maturity:</strong> '+a_mat.split('(')[0].trim()+' Â· <strong>Sector:</strong> '+a_ind+' Â· <strong>Departments:</strong> '+a_dept+' Â· <strong>Geography:</strong> '+a_geo+'</div>';
            html+='<div class="validation-rationale">'+orgRationale()+'</div></div>';
            // 2. Data Estate
            html+='<div class="validation-card"><div class="validation-card-header"><div class="validation-card-title"><span class="vc-icon">ðŸ—„ï¸</span>Data Estate</div>'+fitTag(sc.dataEstate)+'</div>';
            html+='<div class="validation-answer"><strong>Volume:</strong> '+a_vol+' Â· <strong>Refresh:</strong> '+a_freq+' Â· <strong>Sources:</strong> '+a_src+' Â· <strong>Growth:</strong> '+a_growth.split('(')[0].trim()+'</div>';
            html+='<div class="validation-rationale">'+dataRationale()+'</div></div>';
            // 3. Workloads
            html+='<div class="validation-card"><div class="validation-card-header"><div class="validation-card-title"><span class="vc-icon">âš¡</span>Fabric Workloads</div>'+fitTag(sc.workloads)+'</div>';
            html+='<div class="validation-answer"><strong>Workloads:</strong> '+(a_wkl&&a_wkl.length?a_wkl.join(', '):'None selected')+' Â· <strong>Copilot:</strong> '+a_cop+' Â· <strong>Spark sessions:</strong> '+a_spark+' Â· <strong>Models/Reports:</strong> '+a_models+' Â· <strong>CI/CD:</strong> '+a_cicd+'</div>';
            html+='<div class="validation-rationale">'+workloadRationale()+'</div></div>';
            // 4. Users
            html+='<div class="validation-card"><div class="validation-card-header"><div class="validation-card-title"><span class="vc-icon">ðŸ‘¥</span>Users</div>'+fitTag(sc.users)+'</div>';
            html+='<div class="validation-answer"><strong>Peak concurrent:</strong> '+a_usr+' Â· <strong>Total named users:</strong> '+a_total+'</div>';
            html+='<div class="validation-rationale">'+usersRationale()+'</div></div>';
            // 5. Budget
            html+='<div class="validation-card"><div class="validation-card-header"><div class="validation-card-title"><span class="vc-icon">ðŸ’°</span>Budget</div>'+fitTag(sc.budget)+'</div>';
            html+='<div class="validation-answer"><strong>Monthly budget:</strong> '+a_bud+' Â· <strong>Flexibility:</strong> '+a_flex+' Â· <strong>Pause/Resume:</strong> '+a_pause+'</div>';
            html+='<div class="validation-rationale">'+budgetRationale()+'</div></div>';
            html+='</div>';
            // === End Validation Section ===
            html+='<div style="margin-top:28px;padding:16px 20px;background:var(--bg-secondary);border-radius:var(--radius-md);font-size:13px;color:var(--text-secondary);line-height:1.6;">';
            html+='<strong style="color:var(--text-primary);">âš¡ Important:</strong> This is a <strong>recommended starting point</strong>. ';
            html+='Microsoft recommends monitoring via the <a href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app" target="_blank" style="color:var(--accent);">Capacity Metrics App</a> for 2â€“4 weeks then adjusting. F-SKUs can be changed at any time with no downtime.</div>';
            document.getElementById('resultsContent').innerHTML=html;
            document.getElementById('wizardResults').style.display='block';
            setTimeout(function(){drawRadar(sc,'radarChart');},50);
            document.getElementById('wizardResults').scrollIntoView({behavior:'smooth',block:'start'});
        };
        window.resetWizard = function(){
            if(!confirm('Clear all answers?'))return;
            document.querySelectorAll('.fsku-section input[type="radio"],.fsku-section input[type="checkbox"]').forEach(function(e){e.checked=false;});
            document.querySelectorAll('.fsku-section textarea').forEach(function(e){e.value='';});
            document.getElementById('wizardResults').style.display='none';
            goToStage(0);
        };
        window.exportCSV = function(){
            var csv='Section,Question,Answer,Notes\n';
            STAGES.forEach(function(st){st.questions.forEach(function(q){
                var a=q.type==='multi'?getAnswer(q.id,'multi').join('; '):getAnswer(q.id,'single');
                var n=getNote(q.id);
                csv+='"'+st.title+'","'+q.text.replace(/"/g,'""')+'","'+a.replace(/"/g,'""')+'","'+n.replace(/"/g,'""')+'"\n';
            });});
            var blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
            var link=document.createElement('a');link.href=URL.createObjectURL(blob);
            link.download='fsku-assessment-'+new Date().toISOString().slice(0,10)+'.csv';link.click();
        };
        updateProgress();
    })();
    </script>
</body>
</html>